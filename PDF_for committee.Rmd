---
title: "Data analyses report Survey fungicide sensitivity of S. sclerotiorum from drybean and soybean from the U.S."
author: "Nieto_Lopez"
date: "5/7/2019"
output:
  html_document:
    df_print: paged
    toc: TRUE
  pdf_document: default
  html_notebook: default
  word_document: default
---


```{r set packages, warning= FALSE, include=FALSE}
library(tidyverse)
library(ggplot2)
library(ezec)
#library(NRES803)
library(broom)
library(ggridges)
library(cowplot)
library(gridExtra)
library(kableExtra)
library(arsenal)
library(DescTools)
library(knitr)



```

#  Background   

Knowledge of baseline sensitivity of a pathogen population to fungicides is important for detection of resistance and for achieving effective disease management strategies (Brent and Holloman 2007). QoI, DMI, MBC and SDHI fungicides are used to control _S. sclerotiorum_ in an IPM approach in soybean and dry bean in the U.S. DMI fungicides are considered to medium risk of resistance emergence, whereas QoI, SDHI and MBC are high risk (Fungicide Resistance Action Committee 2016). MBC and dicarboximide fungicides are used for white mold in Brazil, wherein resistance to MBC fungicide, Thiophanate methyl, has been reported[^1]. Fungicide resistance has also been reported in China to the  Carbendazim (MBC) and Dimethachlon (dicarboximide)[^3]. Meanwhile in North Central U.S., potential of  resistance to MBC was reported from soybean[^2].


**Commonly Used Fungicides for WM according to the North Central Regional Committee on Soybean Diseases 2015**

| Fungicide | Control | Launched | 
|:------:|:------:|:------:|:------:|
| Thiophanate methyl (MBC) | Fair | 1970 |
| Tetraconazole (DMI) | Fair| 1988| 
| Picoxystrobin (QoI) | Good-very good | 2000  | 
| Boscalid (SDHI) | Very good  | 2003 |

  

Examples of these include: **Topsin**, **Domark**, **Aproach** & **Endura** and several other products are mixtures.  
It is unknown whether efficacy is related to reduce sensitivity within populations under study. 



```{r read data, echo = FALSE}
##  Reading and subsetting data 
boscalid.data <-
  read.csv("data/boscalid_serialdilution_baseline(validationdata).csv")
  boscalid.data <- subset(boscalid.data, select = -X)
  boscalid.data$repeats <- rep_len(1:4, length.out = nrow(boscalid.data))
  boscalid.data$ID <- as.character(boscalid.data$ID)
  # renaming ID for the current names
 boscalid.data$ID[ boscalid.data$ID =="12B"]  <- "12" 
 #Although 74SS1 belong to # 74, the one what I used was specifically this:74SS1
 boscalid.data$ID[ boscalid.data$ID =="74SS1"]  <- "74" 
 boscalid.data$ID[ boscalid.data$ID =="62-02"]  <- "2098" 
 boscalid.data$ID[ boscalid.data$ID =="62-03"]  <- "2099" 
 boscalid.data$ID[ boscalid.data$ID =="62-04"]  <- "2100" 
 boscalid.data$ID[ boscalid.data$ID =="78-01"]  <- "2139" 
 boscalid.data$ID[ boscalid.data$ID =="78-02"]  <- "2140" 
 boscalid.data$ID[ boscalid.data$ID =="78-05"]  <- "2143" 
 boscalid.data$ID[ boscalid.data$ID =="S-01"]  <- "2320" 
 boscalid.data$ID[ boscalid.data$ID =="H-01"]  <- "2220" 
 boscalid.data$ID[ boscalid.data$ID =="H-03"]  <- "2222" 
 boscalid.data$ID[ boscalid.data$ID =="H-04"]  <- "2223"
 boscalid.data$ID[ boscalid.data$ID =="I-20"]  <- "2362"
 boscalid.data$ID[ boscalid.data$ID =="419"]  <- "2385"
 boscalid.data$ID[ boscalid.data$ID =="413"]  <- "2386"
 boscalid.data$ID[ boscalid.data$ID =="W212"]  <- "2388"
 boscalid.data$ID[ boscalid.data$ID =="318"]  <- "2390"

  ####Transforming to $ID to numeric
 boscalid.data$ID <- as.numeric(boscalid.data$ID)
 ## Discarding dose at 0.4 ppm and isolate 800 because it has just one experimental replication ##
 
 # Filter out 
  boscalid.data <- boscalid.data %>%
     filter(!dose ==  0.4 & !ID == 800) %>%
    mutate(polar= replace(polar, polar == 0, 0.6)) %>%  #replacing 0 cm growth for the size of plug that is 0.6
    mutate(ecuatorial= replace(ecuatorial, ecuatorial == 0, 0.6)) %>% #replacing 0 cm growth for the size of plug that is 0.6
    group_by(ID, experimental_replicate, dose, ecuatorial, polar, repeats) %>%
    mutate(growth = ((ecuatorial + polar) / 2))
    
#Reading and subsetting data picoxystrobin
  picoxystrobin.data <-
    read.csv("data/picoxystrobin_serialdi_BL-WMN_survey-WMNCSRP(validationdata).csv")
    picoxystrobin.data$repeats <- rep_len(1:4, nrow(picoxystrobin.data))
    picoxystrobin.data$ID <- as.character(picoxystrobin.data$ID)
    # renaming ID for the current names
    
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="12B"]  <- "12" 
#Although 74SS1 belong to # 74, the one what I used was specifically this:74SS
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="74SS1"]  <- "74" 
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="62-02"]  <- "2098" 
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="62-03"]  <- "2099" 
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="62-04"]  <- "2100" 
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="78-01"]  <- "2139" 
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="78-02"]  <- "2140" 
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="78-05"]  <- "2143" 
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="S-01"]  <- "2320" 
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="H-01"]  <- "2220" 
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="H-03"]  <- "2222" 
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="H-04"]  <- "2223"
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="I-20"]  <- "2362"
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="419"]  <- "2385"
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="413"]  <- "2386"
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="W212"]  <- "2388"
 picoxystrobin.data$ID[ picoxystrobin.data$ID =="318"]  <- "2390"

   ####Transforming to $ID to numeric
picoxystrobin.data$ID <- as.numeric(picoxystrobin.data$ID)
   
  #Filter out 
    picoxystrobin.data <- picoxystrobin.data %>%
      mutate(polar= replace(polar, polar == 0, 0.6)) %>%  #replacing 0 cm growth for the size of plug that is 0.6
    mutate(ecuatorial= replace(ecuatorial, ecuatorial == 0, 0.6)) %>% 
      group_by(ID, experimental_replicate, dose, ecuatorial, polar, repeats) %>%
      mutate(growth = ((ecuatorial + polar) / 2))
      
#Reading and subsetting data tetraconazole
tetraconazole.data <-
  read.csv("data/tetraconazole_serialdi_BL-WMN_survey-WMNCSRP(validationdata).csv")
  tetraconazole.data <- subset(tetraconazole.data, select = -(X:X.1))
  tetraconazole.data$repeats <- rep_len(1:4, length.out = nrow(tetraconazole.data))
  tetraconazole.data$ID <- as.character(tetraconazole.data$ID) 
  # renaming ID for the current names
 tetraconazole.data$ID[ tetraconazole.data$ID =="12B"]  <- "12" 
#Although 74SS1 belong to # 74, the one what I used was specifically this:74SS
 tetraconazole.data$ID[ tetraconazole.data$ID =="74SS1"]  <- "74" 
 tetraconazole.data$ID[ tetraconazole.data$ID =="62-02"]  <- "2098" 
 tetraconazole.data$ID[ tetraconazole.data$ID =="62-03"]  <- "2099" 
 tetraconazole.data$ID[ tetraconazole.data$ID =="62-04"]  <- "2100" 
 tetraconazole.data$ID[ tetraconazole.data$ID =="78-01"]  <- "2139" 
 tetraconazole.data$ID[ tetraconazole.data$ID =="78-02"]  <- "2140" 
 tetraconazole.data$ID[ tetraconazole.data$ID =="78-05"]  <- "2143" 
 tetraconazole.data$ID[ tetraconazole.data$ID =="S-01"]  <- "2320" 
 tetraconazole.data$ID[ tetraconazole.data$ID =="H-01"]  <- "2220" 
 tetraconazole.data$ID[ tetraconazole.data$ID =="H-03"]  <- "2222" 
 tetraconazole.data$ID[ tetraconazole.data$ID =="H-04"]  <- "2223"
 tetraconazole.data$ID[ tetraconazole.data$ID =="I-20"]  <- "2362"
 tetraconazole.data$ID[ tetraconazole.data$ID =="419"]  <- "2385"
 tetraconazole.data$ID[ tetraconazole.data$ID =="413"]  <- "2386"
 tetraconazole.data$ID[ tetraconazole.data$ID =="W212"]  <- "2388"
 tetraconazole.data$ID[ tetraconazole.data$ID =="318"]  <- "2390"

    ####Transforming to $ID to numeric
tetraconazole.data$ID <- as.numeric(tetraconazole.data$ID)
   # Filter out 
  tetraconazole.data <- tetraconazole.data %>%
     mutate(polar= replace(polar, polar == 0, 0.6)) %>%  #replacing 0 cm growth for the size of plug that is 0.6
    mutate(ecuatorial= replace(ecuatorial, ecuatorial == 0, 0.6)) %>% 
    group_by(ID, experimental_replicate, dose, ecuatorial, polar, repeats) %>%
    mutate(growth = ((ecuatorial + polar) / 2))
#Reading and subsetting data TM
  TMdata <-
    read.csv("data/TM_serialdi_BL-WMN_survey-WMNCSRP(validationdata).csv")
    TMdata <- subset(TMdata, select = -(X:X.6))
    TMdata$repeats <- rep_len(1:4, length.out = nrow(TMdata))
    TMdata$ID <- as.character(TMdata$ID)
   # renaming ID for the current names
  TMdata$ID[ TMdata$ID =="12B"]  <- "12" 
 #Although 74SS1 belong to # 74, the one what I used was specifically this:74SS
  TMdata$ID[ TMdata$ID =="74SS1"]  <- "74" 
 TMdata$ID[ TMdata$ID =="62-02"]  <- "2098" 
 TMdata$ID[ TMdata$ID =="62-03"]  <- "2099" 
 TMdata$ID[ TMdata$ID =="62-04"]  <- "2100" 
 TMdata$ID[ TMdata$ID =="78-01"]  <- "2139" 
 TMdata$ID[ TMdata$ID =="78-02"]  <- "2140" 
 TMdata$ID[ TMdata$ID =="78-05"]  <- "2143" 
 TMdata$ID[ TMdata$ID =="S-01"]  <- "2320" 
 TMdata$ID[ TMdata$ID =="H-01"]  <- "2220" 
 TMdata$ID[ TMdata$ID =="H-03"]  <- "2222" 
 TMdata$ID[ TMdata$ID =="H-04"]  <- "2223"
 TMdata$ID[ TMdata$ID =="I-20"]  <- "2362"
 TMdata$ID[ TMdata$ID =="419"]  <- "2385"
 TMdata$ID[ TMdata$ID =="413"]  <- "2386"
 TMdata$ID[ TMdata$ID =="W212"]  <- "2388"
 TMdata$ID[ TMdata$ID =="318"]  <- "2390"

 ####Transforming to $ID to numeric
TMdata$ID <- as.numeric(TMdata$ID)   
  #Filter out the control observations tomething weird happened with the repeats 3 so Iam revoming those
    TMdata <- TMdata %>%
      group_by(ID, experimental_replicate, dose, ecuatorial, polar, repeats) %>%
      filter(!experimental_replicate == 1 |
      !dose == 1.5 | !repeats == 3) %>% # something weird happened with the repeats 3 so Iam revoming those
      mutate(growth = ((ecuatorial + polar) / 2))
      
#Reading and subsetting data of discriminatory dose use
    survey.data <-  read.csv("data/DD_survey-WMNCSRP.csv")
    survey.data <- survey.data %>%
    group_by(
    ID,
    repeats,
    experimental_replicate,
    sham.ecuatorial,
    sham.polar,
    picoxystrobin.ecuatorial,
    picoxystrobin.polar,
    boscalid.ecuatorial,
    boscalid.polar,
    tetraconazole.ecuatorial,
    tetraconazole.polar,
    TM.ecuatorial,
    TM.polar,
    control.ecuatorial,
    control.polar
    ) %>%
        mutate(
    sham.growth = ((sham.ecuatorial + sham.polar) / 2),
    picoxystrobin.growth = ((
    picoxystrobin.ecuatorial + picoxystrobin.polar
    ) / 2),
    boscalid.growth = ((boscalid.ecuatorial + boscalid.polar) / 2),
    tetraconazole.growth = ((
    tetraconazole.ecuatorial + tetraconazole.polar
    ) / 2),
    TM.growth = ((TM.ecuatorial + TM.polar) / 2),
    control.growth = ((control.ecuatorial + control.polar) / 2)
    ) %>%
    ungroup()
    
    survey.data.2 <- survey.data
     survey.data.2$ID <- as.character(survey.data.2$ID)
     # renaming ID for the current names
     survey.data.2$ID[ survey.data.2$ID =="54C"]  <- "2453"
     survey.data.2$ID[ survey.data.2$ID =="65B"]  <- "2528"
      survey.data.2$ID[ survey.data.2$ID =="51C"]  <- "2449"
       survey.data.2$ID[ survey.data.2$ID =="71B"]  <- "2505"
        survey.data.2$ID[ survey.data.2$ID =="64D"]  <- "2518"
         survey.data.2$ID[ survey.data.2$ID =="53B"]  <- "2536"
          survey.data.2$ID[ survey.data.2$ID =="60A"]  <- "2559"
           survey.data.2$ID[ survey.data.2$ID =="H-01"]  <- "2220"
            survey.data.2$ID[ survey.data.2$ID =="H-03"]  <- "2222"
             survey.data.2$ID[ survey.data.2$ID =="419"]  <- "2385"
              survey.data.2$ID[ survey.data.2$ID =="78-02"]  <- "2140"

             survey.data.3 <- survey.data.2 %>% mutate(ID = as.numeric(ID))
# reading the inventory Sclerotinia collection with some of my update modifications
                            WM <- read.csv("data/WM-fixingproductnamesID2573_modifyingforactiveingredient_8.csv", stringsAsFactors = TRUE)
WM$Collection_ID <- str_squish(WM$Collection_ID)
# removing those isolates that are repated and have subsequent ID number becasue they are coming from the previous isolates, for example, 5 & 5A,both are the same, actually 5A is coming from 5,  removing then 5A
WM2 <- 
WM %>% filter(
  !Collection_ID == "5A",
  !Collection_ID == "12Ba",
  !Collection_ID == "12Bb",
  !Collection_ID == "13Bb",
  !Collection_ID == "13Ba",
  !Collection_ID == "13Bb",
  !Collection_ID == "13Bc",
  !Collection_ID == "13E",
  !Collection_ID == "13Ea",
  !Collection_ID == "13Eb",
  !Collection_ID == "13Ec",
  !Collection_ID == "15a",
  !Collection_ID == "15b",
  !Collection_ID == "15c",
  !Collection_ID == "19a",
  !Collection_ID == "19b",
  !Collection_ID == "19c",
  !Collection_ID == "74",
  !Collection_ID == "74-SS-2",
  # removed this one becuase the one used was 74-SS1
  !Collection_ID == "74a",
  !Collection_ID == "74b",
  !Collection_ID == "74c",
  !Collection_ID == "136a",
  !Collection_ID == "136b",
  !Collection_ID == "136c",
  !Collection_ID == "143a",
  !Collection_ID == "143b",
  !Collection_ID == "143c",
  !Collection_ID == "143d",
  !Collection_ID == "143e",
  !Collection_ID == "143f",
  !Collection_ID == "147b",
  !Collection_ID == "147c",
  !Collection_ID == "152a",
  !Collection_ID == "152b",
  !Collection_ID == "152c",
  !Collection_ID == "152d",
  !Collection_ID == "152e",
  !Collection_ID == "152f",
  !Collection_ID == "152g",
  !Collection_ID == "152h",
  !Collection_ID == "152i",
  !Collection_ID == "152j",
  !Collection_ID == "152JR",
  !Collection_ID == "160a",
  !Collection_ID == "160b",
  !Collection_ID == "160c",
  !Collection_ID == "161a",
  !Collection_ID == "161b",
  !Collection_ID == "161c",
  !Collection_ID == "167a",
  !Collection_ID == "167b",
  !Collection_ID == "167c",
  !Collection_ID == "184a",
  !Collection_ID == "184b",
  !Collection_ID == "184c",
  !Collection_ID == "202a",
  !Collection_ID == "202b",
  !Collection_ID == "202c",
  !Collection_ID == "232B",
  !Collection_ID == "245a",
  !Collection_ID == "245b",
  !Collection_ID == "245c",
  !Collection_ID == "247a",
  !Collection_ID == "247b",
  !Collection_ID == "247c",
  !Collection_ID == "248a",
  !Collection_ID == "248b",
  !Collection_ID == "262a",## Any belonging to 262  because it is S trifoliorum
  !Collection_ID == "262b",
  !Collection_ID == "264a",
  !Collection_ID == "264b",
  !Collection_ID == "136c",
  !Collection_ID == "264c",
  !Collection_ID == "274a",
  !Collection_ID == "274b",
  !Collection_ID == "334a",
  !Collection_ID == "334b",
  !Collection_ID == "334c",
  !Collection_ID == "336a",
  !Collection_ID == "336b",
  !Collection_ID == "336c",
  !Collection_ID == "339a",
  !Collection_ID == "339b",
  !Collection_ID == "339c",
  !Collection_ID == "339d",
  !Collection_ID == "339e",
  !Collection_ID == "339f",
  !Collection_ID == "341a",
  !Collection_ID == "341b",
  !Collection_ID == "341c",
  !Collection_ID == "324a",
  !Collection_ID == "342a",
  !Collection_ID == "342b",
  !Collection_ID == "342c",
  !Collection_ID == "346a",
  !Collection_ID == "346b",
  !Collection_ID == "346c",
  !Collection_ID == "353b",
  !Collection_ID == "354a",
  !Collection_ID == "354b",
  !Collection_ID == "354c",
  !Collection_ID == "360b",
  !Collection_ID == "360c",
  !Collection_ID == "361b",
  !Collection_ID == "361c",
  !Collection_ID == "362b",
  !Collection_ID == "362c",
  !Collection_ID == "363b",
  !Collection_ID == "363c",
  !Collection_ID == "364b",
  !Collection_ID == "364c",
  !Collection_ID == "365b",
  !Collection_ID == "365c",
  !Collection_ID == "366b",
  !Collection_ID == "366c",
  !Collection_ID == "367b",
  !Collection_ID == "367c",
  !Collection_ID == "368b",
  !Collection_ID == "368c",
  !Collection_ID == "369b",
  !Collection_ID == "369c",
  !Collection_ID == "370b",
  !Collection_ID == "370c",
  !Collection_ID == "371b",
  !Collection_ID == "371c",
  !Collection_ID == "372b",
  !Collection_ID == "372c",
  !Collection_ID == "373b",
  !Collection_ID == "373c",
  !Collection_ID == "374b",
  !Collection_ID == "374c",
  !Collection_ID == "375a",
  !Collection_ID == "375b",
  !Collection_ID == "376b",
  !Collection_ID == "376c",
  !Collection_ID == "377b",
  !Collection_ID == "377c",
  !Collection_ID == "400a",
  !Collection_ID == "400b",
  !Collection_ID == "973A",
  !Collection_ID == "973B",
  !Collection_ID == "973C",
  !Collection_ID == "973D",
  !Collection_ID == "973E",
  !Collection_ID == "974A",
  !Collection_ID == "974B",
  !Collection_ID == "974C",
  !Collection_ID == "974D",
  !Collection_ID == "974E",
  !Collection_ID == "975A",
  !Collection_ID == "975B",
  !Collection_ID == "975C",
  !Collection_ID == "975D",
  !Collection_ID == "975E",
  !Collection_ID == "976A",
  !Collection_ID == "976B",
  !Collection_ID == "976C",
  !Collection_ID == "976D",
  !Collection_ID == "976E",
  !Collection_ID == "977A",
  !Collection_ID == "977B",
  !Collection_ID == "977C",
  !Collection_ID == "977D",
  !Collection_ID == "977E",
  !Collection_ID == "978A",
  !Collection_ID == "978B",
  !Collection_ID == "978C",
  !Collection_ID == "978D",
  !Collection_ID == "978E",
  !Collection_ID == "979A",
  !Collection_ID == "979B",
  !Collection_ID == "979C",
  !Collection_ID == "979D",
  !Collection_ID == "979E",
  # These are cross out on the inventory list
  !Collection_ID == "1048",
  !Collection_ID == "1049",
  !Collection_ID == "1227",
  !Collection_ID == "1228",
  !Collection_ID == "2217",
  !Collection_ID == "2219",
  !Collection_ID == "2225",
  !Collection_ID == "2226",
  !Collection_ID == "2230",
  !Collection_ID == "2245",
  !Collection_ID == "2307",
  !Collection_ID == "2320",
  !Collection_ID == "2325",
  !Collection_ID == "2327",
  !Collection_ID == "2329",
  !Collection_ID == "2352",
  !Collection_ID == "2366",
  !Collection_ID == "2367",
  !Collection_ID == "2369",
  !Collection_ID == "2373",
  !Collection_ID == "2375",
  !Collection_ID == "2380",
  !Collection_ID == "2387",
  !Collection_ID == "2389",
  !Collection_ID == "2392",
  !Collection_ID == "973D",
  # cleaning thsi isolates that are useless becuase non information
  !Collection_ID == "429",
  !Collection_ID == "433",
  !Collection_ID == "442",
  !Collection_ID == "1048",
  !Collection_ID == "1049",
  !Collection_ID == "2217",
  !Collection_ID == "2219",
  !Collection_ID == "2226",
  !Collection_ID == "2245",
  !Collection_ID == "2307",
  !Collection_ID == "2327",
  !Collection_ID == "2352",
  !Collection_ID == "2366",
  !Collection_ID == "2367",
  !Collection_ID == "2380",
  !Collection_ID == "2392", 
  !Collection_ID == "2343",  #Yuba Experiment not enough information
!Collection_ID== "2344", #Yuba Experiment
!Collection_ID== "2345", #Yuba Experiment
!Collection_ID== "2346", #Yuba Experiment
!Collection_ID== "2347", #Yuba Experiment
!Collection_ID== "2348", #Yuba Experiment
!Collection_ID== "2349", #Yuba Experiment
!Collection_ID== "2350", #Yuba Experiment
!Collection_ID== "2351", #Yuba Experiment
!Collection_ID== "2352", #Yuba Experiment
!Collection_ID== "2353", #Yuba Experiment
!Collection_ID== "2354", #Yuba Experiment
!Collection_ID== "2355", #Yuba Experiment
!Collection_ID== "2356", #Yuba Experiment
!Collection_ID== "2357", #Yuba Experiment
!Collection_ID== "2358", #Yuba Experiment
!Collection_ID== "2359", #Yuba Experiment
!Collection_ID== "2360", #Yuba Experiment
!Collection_ID== "2361", #Yuba Experiment
!Collection_ID== "2362", #Yuba Experiment
!Collection_ID== "2363", #Yuba Experiment
!Collection_ID== "2364", #Yuba Experiment
!Collection_ID== "2365", #Yuba Experiment
!Collection_ID== "2366", #Yuba Experiment
!Collection_ID== "2367", #Yuba Experiment
!Collection_ID== "2368", #Yuba Experiment
!Collection_ID== "2369", #Yuba Experiment
!Collection_ID== "2370", #Yuba Experiment
!Collection_ID== "2371", #Yuba Experiment
!Collection_ID== "2372", #Yuba Experiment
!Collection_ID== "2373", #Yuba Experiment
!Collection_ID== "2374", #Yuba Experiment
!Collection_ID== "2375", #Yuba Experiment
!Collection_ID== "2376", #Yuba Experiment
!Collection_ID== "2377", #Yuba Experiment
!Collection_ID== "2378", #Yuba Experiment
!Collection_ID== "2379", #Yuba Experiment
!Collection_ID== "2380", #Yuba Experiment
!Collection_ID== "2381" #Yuba Experiment
  ) %>% 
  rename(ID= Collection_ID)
  # Since here changing the names Changing the names, for example there is no 12, it goes directly to 12B, so this 12B is gonna be the 12 now
WM2$ID[ WM2$ID =="12B"]  <- "12"
WM2$ID[ WM2$ID =="13B"]  <- "13"
 #Although 74SS1 belong to # 74 the that I used was specifically this, 74SS1
WM2$ID[ WM2$ID =="74-SS-1"]  <- "74"
WM2$ID[ WM2$ID =="125 SS-4"]  <- "125"
WM2$ID[ WM2$ID =="232A"]  <- "232"
WM2$ID[ WM2$ID =="359b"]  <- "359"
WM2$ID[ WM2$ID =="360a"]  <- "360"
WM2$ID[ WM2$ID =="361a"]  <- "361"
WM2$ID[ WM2$ID =="362a"]  <- "362"
WM2$ID[ WM2$ID =="363a"]  <- "363"
WM2$ID[ WM2$ID =="364a"]  <- "364"
WM2$ID[ WM2$ID =="365a"]  <- "365"
WM2$ID[ WM2$ID =="366a"]  <- "366"
WM2$ID[ WM2$ID =="367a"]  <- "367"
WM2$ID[ WM2$ID =="368a"]  <- "368"
WM2$ID[ WM2$ID =="369a"]  <- "369"
WM2$ID[ WM2$ID =="370a"]  <- "370"
WM2$ID[ WM2$ID =="371a"]  <- "371"
WM2$ID[ WM2$ID =="372a"]  <- "372"
WM2$ID[ WM2$ID =="373a"]  <- "373"
WM2$ID[ WM2$ID =="374a"]  <- "374"
WM2$ID[ WM2$ID =="375c"]  <- "375"
WM2$ID[ WM2$ID =="376a"]  <- "376"
WM2$ID[ WM2$ID =="377a"]  <- "377"

  
 


```

```{r, echo = FALSE}
WM3 <- WM2 %>% mutate(
  ID = as.numeric(ID),
  long = as.numeric(as.character(long)), 
       long =  long * -1, 
      DNA.Extraction = recode(DNA.Extraction, 
      No = "No DNA extraction",
      Yes = "Yes DNA extraction", .default = "No DNA extraction") 
  )

```

# Hypotheses  

1. Some _S. sclerotiorum_ isolates from fungicide field trials and farmer fields will have decreased sensitivity to commonly used fungicides in the U.S.  

2. Some _S. sclerotiorum_ isolates from dry beans will have decreased sensitivity compared to those from soybeans.

```{r setting objects, echo = FALSE}
#replacing with the sourceal ID, for example, instead of 12b, now 12
baseline_isolates <- c(1, 8, 12, 20, 21, 74, 87, 118, 123, 129, 449, 461, 467, 475, 558, 564, 568, 581, 645, 667, 800)

survey_isolates <-  c( 2385, 2386, 2098, 2099, 2100, 2139, 2140, 2143, 2220, 2222, 2223, 2320, 2362, 2388, 2390 )

Farmer_fields <- c(136:442, 455, 456, 466, 468, 470, 471, 478:554, 602:610, 612:635, 671, 672, 682:690, 695:797, 810:823, 834, 835, 848:1024, 1255: 1326, 1491: 1500, 1661:1670, 1831: 2246, 2303: 2342,2362: 2381, 2393: 2573)

baseline_isolates_2 <- c(1: 136, 444: 454, 457: 465, 467, 469, 472:477, 555:601, 611, 636:670, 673: 680, 691:694 , 798: 809,  824: 833, 836: 847)

drybean <- c(1, 5, 12,13:118, 123:128, 133:135, 145, 146, 152, 155:160, 182: 185, 194:200, 205, 220, 223, 248, 253:255, 274, 279, 280, 290, 294, 304: 309, 323, 358, 393, 395, 396, 397, 400:402, 405, 408, 409, 434, 443:465, 467, 469: 493, 495:505, 555:613, 615: 760, 762: 819, 824:833, 835:855, 858:921, 966: 971, 980, 981, 985: 996, 998: 1009, 1220:1225 , 1857: 1940, 2242: 2569)

soybean <- c(143, 147, 181, 187, 188, 189,202, 257: 259, 264:268, 276, 281, 289, 293, 295, 310 , 399, 412:417, 419, 425:427, 439, 440, 494, 506:554, 834, 972:979, 982, 997, 1010: 1022, 1025:1219, 1229: 1856, 1941: 2241 )

SI_Production_Field <- c( 698:741, 743:744, 746:760, 762: 778, 
786: 797, 810:819, 848: 855, 858: 914)

SI_Screening_Nursery_Field <- c(444:454, 457:465, 467, 469, 472:477, 555: 582, 584: 601, 611, 636:670, 673:681,691:694, 798:809, 824: 833 , 836:847)# also taking into account WM Monitor 

Fungicide_field_trials <- 

#Fungicides single mode of action
Group_one <- c("thiophanate_methyl")
Group_3 <- c( "prothioconazole", "tetraconazole", "flutriafol", "propiconazole", "tebuconazole", "difenoconazole")
Group_7 <- c("fluxapyroxad", "boscalid")
Group_11 <- c("picoxystrobin", "azoxystrobin", "fluoxastrobin", "pyraclostrobin", "trifloxystrobin")

not_considered <- c("potassium phosphite")

#Mixxes of fungicides IN COMERCIAL PRODUCTS

 Group_3_Group_11 <-  c(
   "flutriafol + fluoxastrobin",
   "tetraconazole + pyraclostrobin", #there 2 fungicides: single MOA(tetraconazole) + single MOA( pyraclostrobin) #Put attention for the mixxes analyses with 2 single MOA!!
   "propiconazole + azoxystrobin",
"prothioconazole + trifloxystrobin", 
"tetraconazole + fluatriafol + fluxastrobin", #there 2 fungicides: single MOA(tetraconazole) + mix( flutriafol + fluxastrobin) #Put attention for the mixxes mixxes analyses with 2 single MOA!!
"difenoconazole + azoxystrobin")
 
Group_7_Group_11 <- c(
  "fluxapyroxad + pyraclostrobin", 
  "pyraclostrobin + fluxapyroxad + pyraclostrobin")  #there 2 fungicides: single MOA(pyraclostrobin) + mix( fluxapyroxad + pyraclostrobin) #Put attention for the mixxes mixxes analyses with 2 single MOA!!                     
                     
 Group_3_not_considered <- "tebuconazole + potassium phosphite"
 
  unknown <- c("No_info")
 
#converting these levels of factors where is NA in now unknown
  
  

levels(WM3$Fungicide_current_season)[levels(WM3$Fungicide_current_season) == ""] <- "unknown"

levels(WM3$molecule.s._current_season)[levels(WM3$molecule.s._current_season) == ""] <- "unknown"

levels(WM3$molecule.s._current_season)[levels(WM3$molecule.s._current_season) == "No_info"] <- "unknown"

levels(WM3$Fungicide_previous_seasons)[levels(WM3$Fungicide_previous_seasons) == ""] <- "unknown"


levels(WM3$molecule.s._previous_seasons)[levels(WM3$molecule.s._previous_seasons) == ""] <- "unknown"



WM3_ <- WM3%>%
  # transforming this variable in character
  mutate(molecule.s._current_season = as.character(WM3$molecule.s._current_season)) %>% 
  #creating a new variable called Group_MOA based if they are in the corresponding objects, if not is named "unknown" 
  mutate(
    Group_MOA_current_season = case_when(
       molecule.s._current_season%in% Group_one ~ "Group_one",# filtering and naming "the name of the group" in case of in
       molecule.s._current_season%in% Group_3~ "Group_3",
       molecule.s._current_season%in% Group_7 ~ "Group_7",
       molecule.s._current_season%in% Group_11 ~ "Group_11", molecule.s._current_season%in% Group_3_Group_11~ "Group_3&Group_11",
       molecule.s._current_season%in% Group_7_Group_11~ "Group_7&Group_11",
       molecule.s._current_season%in% Group_3_not_considered~ "Group_3&not_considered",
       molecule.s._current_season%in% unknown~ "unknown", #this consider the control CHECK this out unknown
             TRUE ~ "unknown"# in case of not, naming "not_selected""
    ), 
    Group_MOA_previous_seasons = case_when(
       molecule.s._previous_seasons%in% Group_one ~ "Group_one",# filtering and naming "the name of the group" in case of in
       molecule.s._previous_seasons%in% Group_3~ "Group_3",
       molecule.s._previous_seasons%in% Group_7 ~ "Group_7",
       molecule.s._previous_seasons%in% Group_11 ~ "Group_11", molecule.s._previous_seasons%in% Group_3_Group_11~ "Group_3&Group_11",
       molecule.s._previous_seasons%in% Group_7_Group_11~ "Group_7&Group_11",
       molecule.s._previous_seasons%in% Group_3_not_considered~ "Group_3&not_considered",
       molecule.s._previous_seasons%in% unknown~ "unknown", #this consider the control CHECK this out unknown
             TRUE ~ "unknown"# in case of not, naming "not_selected""
    ) )   


  

```
# Collection
In 2016, and 2017, we conducted a survey of _S. sclerotiorum_ from soybean in NE, IA, WI, and MI, resulting in a collection of 1,369 isolates, which included farmer fields and fungicide field trials. In 2003 to 2012, 366 isolates were collected and characterized previously from white mold screening nurseries or producer fields throughout dry bean and snap bean production areas across the US, with others collected in prior years.  

From these, we randomly selected 207 isolates: 93 from dry beans (18 ND, 16 MI, 16 WA, 15 CO, 11 NE, 2 DE, 2 MN, 2 WI, 1 OR, 6 from Brazil and, 4 from Mexico) and 114 from soybeans (48 NE, 25 MI, 24 IA, and 17 WI). Isolates were from farmer fields (FF), fungicide field trials (FFT), and fields without fungicide applications, that latter were called baseline.

# Fungicides used:
1. Boscalid (SDHI)  
2. Picoxystrobin (QoI)  
3. Tetraconazole (DMI)  
4. Thiophanate methyl (MBC)  

#  Fungicide sensitivity by fungicide
## Serial dilution
Fungicide sensitivity was determined since 21 baseline isolates plus 21 additional isolates from FF and FFT randomly selected. Serial dilution  by fungicide eas carried out from 5-6 concentrations with 4 repetitions per isolate and 2 experimental replications. Plates were incubated in darkness at 23 ± 2 °C for 42 h and diameter measured with digital calipers. A dose-response curve was fit to estimate the EC50 for each fungicide.  

## Procedure to get the Discriminatory Concentration (DC)  

We identified the concentration with the best prediction of EC50 for each fungicide, known as discriminatory concentration (DC), by linear regression of % mycelial growth vs. log(EC50). The concentration yielding the highest coefficient of determination (r2) was selected as the DC for each fungicide. For the remaining isolates among the 207, growth on the DC was used to estimate EC50, which is termed EC50(D).

##  Use of the Discriminatory Concentration DC

We randomly selected 154 isolates: 86 from dry beans (from 9 states with 1-17 isolates/state, and 2 states from Brazil) and 66 from soybeans (6 NE, 18 IA, 13 WI & 18 MI and 4 from Mexico)  from the collection (baseline, FF, and FF) plus 5 same isolates used in the serial dilution approach.

##  Statistic Analysis 


In the following section we will show the results for each fungicide.


```{r function to take outliers from 8 observations, echo = FALSE}
get_range <- function(mynumber) {
  bb <- boxplot.stats(mynumber)
  cc <- bb$stats
  dd <- max(cc)
  ee <- min(cc)
  return(data.frame(upper = dd, lower = ee))
}
```

# Boscalid, an example of fungicide analyses
## Serial dilution

```{r Serial dilution Boscalid, include = FALSE}
#Boscalid fungicide taking the outliers from the 8 observations of each one USING THE FUCTION 
boscalid.filtered  <- boscalid.data %>%
  group_by(ID, dose) %>%
  mutate(growth_range = list(get_range(growth))) %>%
  unnest() %>% 
  filter(growth <= upper & growth >= lower) %>%
  rename(response = growth) %>%
  ungroup() %>%
  select(c(ID, experimental_replicate, repeats, dose, response))

#Boxplot by experimental replicate,  I would need to remove one replicate from 2d experimental replicate for ID= 1032, one replicate from each experimental replicate for ID = 2222 and one repeat from 2nd experimental replicate for ID= 1032
#Boxplot by repeats,   I would need to remove For ID= 1032, the 4th repeat, and For ID= 2222,  the repeat 3,

# Getting EC50 by EC_table #
xx <- EC_table(boscalid.filtered, form = response ~ dose)

boscalid.xx <-
  xx %>% rename(ID = sample ) %>% # renaming
  rename(EC50 = Estimate.50) %>%
   group_by(ID, EC50) %>%
  mutate(group = ifelse(
    ID %in% baseline_isolates,# if they are in this group
    "baseline",
    ifelse(
      ID %in% survey_isolates, # if they are in this group, that is named farmer fiels also ahead
      "survey_isolates",
      "treatmentyear2016_isolates" # if they are in this group, that is named fungicide field trials also ahead
      ))) %>% ungroup() %>% 
     mutate(fungicide = "Boscalid") %>% 
  mutate(group = recode(group, survey_isolates = "Farmer fields", treatmentyear2016_isolates = "Fungicide field trials", baseline = "Baseline")) %>% mutate(group = as.factor(group)) %>% 
  ungroup()

```

```{r, echo = FALSE}
xx
```


## Procedure to get the Discriminatory Concentration (DC)  

```{r Calculus of DC Boscalid, include=FALSE}
##Getting relative growth column at each dose where RG = Relative Growth, eg. RG0.025 = Relative Growth at 0.025 ppm##
RG.boscalid <-
  boscalid.filtered %>% group_by(ID, dose) %>% summarise(mean_response = mean(response, na.rm = TRUE)) %>%
  spread(dose, mean_response) %>%
  mutate(RG0.025 = ((`0.025` / `0`) * 100)) %>%    
     mutate(RG0.05 = ((`0.05` / `0`) * 100)) %>%
        mutate(RG0.05 = ((`0.05` / `0`) * 100)) %>%  
          mutate(RG0.1 = ((`0.1` / `0`) * 100)) %>%
            mutate(RG0.2 = ((`0.2` / `0`) * 100)) %>%
              mutate(RG0.8 = ((`0.8` / `0`) * 100)) %>% 
  ungroup()
#Since here EC50 is known as Estimate EC50 from EC50 table and normalizing data
final.boscalid <-#joining
  left_join (RG.boscalid, boscalid.xx) %>% # normalizing data
  mutate(logEC50 = (log(EC50))) %>% 
rename(Estimate.50 = EC50)# #Since here EC50 is known as Estimate EC50 from EC50 table 

####################################################################################
###Dose chosen as DC. Although there is one dose with higher r2, there is no difference between and this was selected
# Linear model of log EC50 and relative growth at 0.2 ppm, check normality and homogeneity of variances
finalRG0.2 <- lm(logEC50 ~ RG0.2, final.boscalid)
summary(finalRG0.2)
#plot(finalRG0.2)

##taking out outliers from Q-Q PLOT $ LEVERAGE TEST, ISOLATES # 1032 from treatment, 2222 & 2223 from Farmer fields##
final.boscalid.clean <-
  final.boscalid %>% filter(!ID == "1032", !ID == "2222",!ID == "2223")
 
 finalRG0.2 <- lm(logEC50 ~ RG0.2, final.boscalid.clean)
  summary(finalRG0.2)
  plot(finalRG0.2)
  
# Linear Regression graph of log EC50 and relative growth at 0.2 ppm

 fig.1 <-    ggplot(finalRG0.2, aes(x = RG0.2, y = logEC50)) +  geom_point() + geom_smooth(method = "lm") +  theme(
    plot.title = element_text(
    size = 10,
    face = "bold",
    hjust = 0.5,
    family = "Verdana"
    ),
    axis.title = element_text(size = 10, face = "bold", hjust = 0.5),
    axis.text = element_text(
    face = "bold",
    size =10,
    family = "Verdana"
    ),
    panel.background = element_rect(fill = "white", colour = "grey50")
    ) + labs(title = "Linear regression between EC50 values & relative growth of Boscalid at 0.2 ppm", x =
    "Relative growth (%)", y = "Log EC50")
    

# Getting the EC50DC according to the model
final.boscalid.DC <-
  final.boscalid.clean %>% mutate(Estimate.50DC =
                                     #using the model the intercept and the coefficient of the model
                                    exp(finalRG0.2[[1]][[1]] + finalRG0.2[[1]][[2]] * RG0.2)) %>%# here I need to do this dynamic
  select(ID, Estimate.50DC, Estimate.50)


# Linear model of EC50  and EC50DC just to corroborate is a GOOD RELATIONSHIP, check normality and homogeneity of variances
final.boscalid.DC.0.2 <- lm (Estimate.50DC ~ Estimate.50, final.boscalid.DC ) 
summary(final.boscalid.DC.0.2)
 #kable(tidy(final.boscalid.DC.0.2), digits = 3)

kable(tidy(final.boscalid.DC.0.2), digits = 3, format = "markdown", caption = "Table with outliers for each fungicide, NA= never tested , 0=  not an outlier but tested, 1 = outlier", padding = 0, align = "l")

#plot(final.boscalid.DC.0.2)

#pdf("Linear regression of boscalid 0.2 ppm.pdf")  
fig.2<- ggplot(final.boscalid.DC.0.2, aes(x = Estimate.50, y = Estimate.50DC)) +  theme(
  plot.title = element_text(
  size = 10,
  face = "bold",
  hjust = 1,
  family = "Verdana"
  ),
  axis.title = element_text(size = 10, face = "bold", hjust = 0.5),
  axis.text = element_text(
  face = "bold",
  size = 10,
  family = "Verdana"
  ),
  panel.background = element_rect(fill = "white", colour = "grey50")
  ) + labs(title = "Linear regression between EC50 and EC50(D) values of Boscalid ", x =
  "EC50 (ppm)", y = "EC50(D) (ppm)") + geom_point(shape = 24) + geom_smooth(method = "lm")


 
```

```{r, echo= FALSE}
fig.1 
kable(tidy(final.boscalid.DC.0.2), digits = 3, format = "markdown", caption = "Table with outliers for each fungicide, NA= never tested , 0=  not an outlier but tested, 1 = outlier", padding = 0, align = "l")
final.boscalid.DC
fig.2
```

##  Use of the Discriminatory Concentration (DC) 
```{r Using the DC Boscalid and the model, echo = FALSE}
boscalid_data <- survey.data.3 %>%
  select(ID,
         repeats,
         experimental_replicate,
         boscalid.growth,
         control.growth) %>%
  rename(response = boscalid.growth, control = control.growth) 

# Using the previous  function in order to take out the outliers
boscalid.filtered.survey <- boscalid_data %>%
  group_by(ID) %>%
  mutate(response_range = list(get_range(response))) %>%
  unnest() %>%
  mutate(control_range = list(get_range(control))) %>%
  unnest() %>%
  filter(response <= upper &
           response >= lower,
         control <= upper1 & control >= lower1) %>%
  ungroup() %>%
  select(c(ID, experimental_replicate, repeats, response, control))

#  Using the model to estimate the EC50DC
boscalid.filtered. <- boscalid.filtered.survey %>%
  group_by(ID) %>%
  summarise(
  mean_response = mean(response, na.rm = TRUE),
  mean_control = mean(control, na.rm = TRUE)
  ) %>%
  mutate(RG = (mean_response / mean_control) * 100) %>%
  
  mutate(Estimate.50DC = exp # exponential is the opposite of log
        #using the model the intercept and the coefficient of the model
          (finalRG0.2[[1]][[1]] + finalRG0.2[[1]][[2]] * RG)) %>% ungroup() %>% 
  rename(EC50DC= Estimate.50DC) %>% 
  mutate(ID = as.numeric(ID)) %>% 
   select(c(ID, EC50DC)) 

```

```{r, echo= FALSE}
boscalid.filtered.
```

```{r wrangling Boscalid, echo = FALSE}

#Selecting the EC50D from the serial dilution
boscalid.complete <- final.boscalid.DC %>% 
 ####WATCH OUT, Based on EC50DC
   rename(EC50DC = Estimate.50DC) %>% 
  select(ID, EC50DC) %>% 
  bind_rows(boscalid.filtered.) %>% 
ungroup() %>%  
  mutate( ID= as.numeric(ID)) %>% 
  group_by(ID) %>%
  top_n(1, EC50DC) %>%
  ungroup() %>% 
    mutate(source = ifelse(
    ID %in% baseline_isolates_2,
    "Baseline",
    ifelse(
      ID %in% Farmer_fields,
      "FF","FFT"
    )), Host = ifelse(
    ID %in% drybean,
    "Drybean", ifelse(
      ID %in% soybean,
      "Soybean","different_host"
    ))) %>% 
    mutate(source = as.factor(source), Host= as.factor(Host)) %>% 
#taking out "different host" becuse does not belong to drybean nor soybean
  filter(!ID == 8,!ID == 129 )

```



## Statistical analysis
### By Source
```{r, include= FALSE}


##NORMALITY TEST-Shapiro_test

shapiro.test.boscal <- boscalid.complete %>%
  group_by(source) %>%
  do(tidy(shapiro.test(.$EC50DC)))
shapiro.test.boscal 



 #NO NORMALILTY thats is why  krusKal
#by source

object.1 <- kruskal.test(EC50DC ~ source, data = boscalid.complete)

#There is difference p-value = 1.25 *10 -05

object.2 <-  DunnTest(EC50DC ~ source, data = boscalid.complete, method = "bonferroni")
#P VALUE 0.00057 *** FF-Baseline
#P VALUE 0.00093 *** FFT-FF


```

```{r, echo= FALSE}
shapiro.test.boscal 

object.1 

object.2
```



```{r, echo= FALSE}
plot.bos <- boscalid.complete%>%
  ggplot(aes(x = source, y = EC50DC)) +
  geom_jitter(
    width = .1,
    height = 0,
    shape = 21,
    color = "black",
    fill = "chartreuse2",
    size = 2,
    alpha = 3 / 4
  ) + stat_summary(
    fun.y = mean,
    geom = "point",
    shape = 95,
    size = 22,
    color = "black"
  ) +
  theme_minimal() +
  labs( x = "source", y = "EC50 (ppm)") + theme(
    panel.border = element_rect(colour = "black", fill=NA, size=1),
    axis.title = element_text(size = 10, face = "bold", hjust = 0.5),
    axis.text = element_text(
      face = "bold",
      size = 7,
      family = "Verdana"
    ),
    panel.background = element_rect(fill = "white", colour = "grey50" )
  )

plot.bos




```

```{r, echo= FALSE, warning= FALSE}
hola <- (max(boscalid.complete$EC50DC)-min(boscalid.complete$EC50DC))/7
boscalid_group1 <- min(boscalid.complete$EC50DC) + hola    
boscalid_group2 <- min(boscalid.complete$EC50DC) + 2*hola     
boscalid_group3 <- min(boscalid.complete$EC50DC) + 3*hola 
boscalid_group4 <- min(boscalid.complete$EC50DC) + 4*hola 
boscalid_group5 <- min(boscalid.complete$EC50DC) + 5*hola  
boscalid_group6 <- min(boscalid.complete$EC50DC) + 6*hola  
boscalid_group7 <- min(boscalid.complete$EC50DC) + 7*hola  

boscalid.complete.groups <- boscalid.complete %>% 
mutate(group =ifelse( 
  EC50DC <= boscalid_group1, 1, 
  ifelse(EC50DC <= boscalid_group2, 2,
     ifelse(EC50DC <= boscalid_group3, 3,    
         ifelse(EC50DC <= boscalid_group4, 4,
                ifelse(EC50DC <= boscalid_group5, 5,
                       ifelse(EC50DC <= boscalid_group6, 6,
                              ifelse(EC50DC <= boscalid_group7, 7, 0
         ) )))))))


boscalid.complete.groups%>%
group_by(source, group) %>%
summarize(N_isolates= n()) %>%
ggplot(aes(x = group, y= N_isolates, fill= source)) +
geom_bar(stat = "identity", position=position_dodge()) +
geom_smooth(method = "loess", se = FALSE, aes(color= source))+
theme_minimal() +
  labs( x = "EC50DC", y = "Number of isolates") + theme(
    panel.border = element_rect(colour = "black", fill=NA, size=1),
    axis.title = element_text(size = 12, face = "bold", hjust = 0.5),
    axis.text = element_text(
      face = "bold",
      size = 12,
      family = "Verdana"
    ),
    panel.background = element_rect(fill = "white", colour = "grey50" )
  ) 



```


### By Host
```{r, echo = FALSE}
#by hosts

# No normals
shapiro.test.boscal.2 <- boscalid.complete%>%
  group_by(Host) %>%
  do(tidy(shapiro.test(.$EC50DC)))
shapiro.test.boscal.2


kruskal.test(EC50DC ~ Host, data = boscalid.complete)
#There is NO difference p-value 0.06043

```


```{r, echo = FALSE, warning= FALSE}
plot.bos.2 <- boscalid.complete%>%
  ggplot(aes(x = Host, y = EC50DC)) +
  geom_jitter(
    width = .1,
    height = 0,
    shape = 21,
    color = "black",
    fill = "chartreuse2",
    size = 2,
    alpha = 3 / 4
  ) + stat_summary(
    fun.y = mean,
    geom = "point",
    shape = 95,
    size = 22,
    color = "black"
  ) +
  theme_minimal() +
  labs( x = "Group", y = "EC50 (ppm)") + theme(
    panel.border = element_rect(colour = "black", fill=NA, size=1),
        axis.title = element_text(size = 10, face = "bold", hjust = 0.5),
    axis.text = element_text(
      face = "bold",
      size = 7,
      family = "Verdana"
    ),
    panel.background = element_rect(fill = "white", colour = "grey50")
  )

plot.bos.2

boscalid.complete.groups%>%
group_by(Host, group) %>%
summarize(N_isolates= n()) %>%
ggplot(aes(x = group, y= N_isolates, fill= Host)) +
geom_bar(stat = "identity", position=position_dodge()) +
geom_smooth(method = "loess", se = FALSE, aes(color= Host))+
theme_minimal() +
  labs( x = "EC50DC", y = "Number of isolates") + theme(
    panel.border = element_rect(colour = "black", fill=NA, size=1),
    axis.title = element_text(size = 12, face = "bold", hjust = 0.5),
    axis.text = element_text(
      face = "bold",
      size = 12,
      family = "Verdana"
    ),
    panel.background = element_rect(fill = "white", colour = "grey50" )
  ) 

```

#  Literature cited

1. Lehner, M. S., Paula Júnior, T. J., Silva, R. A., Vieira, R. F., Carneiro, J. E. S., Schnabel, G., & Mizubuti, E. S. G. 2015. Fungicide sensitivity of _Sclerotinia sclerotiorum_: A thorough assessment using discriminatory dose, EC50, high-resolution melting analysis, and description of new point mutation associated with thiophanate-methyl resistance. _Plant disease_, 99: 1537-1543.   
2. Mueller, D. S., Dorrance, A. E., Derksen, R. C., Ozkan, E., Kurle, J. E., Grau, C. R., & Pedersen, W. L. 2002. Efficacy of fungicides on _Sclerotinia sclerotiorum_ and their potential for control of Sclerotinia stem rot on soybean. _Plant disease_, 86: 26-31.  
3. Zhou, F., Zhu, F. X., Zhang, X. L., & Zhang, A. S. 2014. First report of dimethachlon resistance in field isolates of _Sclerotinia sclerotiorum_ on oilseed rape in Shaanxi Province of northwestern China. _Plant Disease_, 98: 568-568. 
