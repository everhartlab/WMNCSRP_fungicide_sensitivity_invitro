---
title: "Cristian_Survey fungicide sensitivity of S. sclerotiorum from drybean"
author: "Nieto_Lopez"
date: "8/6/2019"
output:
  word_document: default
  pdf_document: default
  html_document:
    df_print: paged
---


```{r set packages, warning= FALSE, include=FALSE}
load("Main.Rdata", .GlobalEnv)
load("all.2.Rdata", .GlobalEnv)
library(tidyverse)
library(ggplot2)
library(ezec)
#library(NRES803)
library(broom)
library(ggridges)
library(cowplot)
library(gridExtra)
library(kableExtra)
library(arsenal)
library(DescTools)
library(knitr)
library(agricolae)


```

#  Background   

Knowledge of baseline sensitivity of a pathogen population to fungicides is important for detection of resistance and for achieving effective disease management strategies (Brent and Holloman 2007). QoI, DMI, MBC and SDHI fungicides are used to control _S. sclerotiorum_ in an IPM approach in soybean and dry bean in the U.S. DMI fungicides are considered to medium risk of resistance emergence, whereas QoI, SDHI and MBC are high risk (Fungicide Resistance Action Committee 2016). MBC and dicarboximide fungicides are used for white mold in Brazil, wherein resistance to MBC fungicide, Thiophanate methyl, has been reported (Lehner et al. 2015). Fungicide resistance has also been reported in China to the MBC, Carbendazim and dicarboximide, Dimethachlon (Ma et al. 2009).

COMMONLY USED FUNGICIDES FOR WM .

Thiophanate methyl (MBC) fair control; launched 1970
Tetraconazole (DMI)  fair control; launched 1988
Picoxystrobin (QoI) good-very good control; launched 2000
Boscalid (SDHI) very good control; launched 2003
Examples of these include: Topsin, Domark, Aproach & Endura
Several other products are mixtures

MBC: Methyl Benzimidazole Carbamates 
DMI: DeMethylation Inhibitors 
QoI: Quinone outside Inhibitors 
SDHI: Succinate dehydrogenase inhibitors 

Field applications of fungicides in the United States on soybean show control of _S. sclerotiorum_ is low to fair for QoI, DMI and MBC fungicides, and good for SDHI fungicides (The North Central Regional Committee on Soybean Diseases 2015). However, it is unknown whether efficacy is related to reduce sensitivity within populations under study. 


# Fungicides
## Boscalid
## Picoxystrobin
## Tetraconazole
## Thiophanate methyl

# Boscalid 
##  Reading the data
```{r read data Boscalid, echo = FALSE, include=FALSE}
glimpse(boscalid.data.cristian)
 

```
## Discriminatory concentration in Boscalid
```{r Using the DC Boscalid and the model, echo = FALSE, warning=  FALSE}
# Using the function to take out outliers
 boscalid.data.cristian.2 <- boscalid.data.cristian %>%
    rename(response = boscalid.growth, control = control.growth) %>% 
     group_by(ID) %>%
    mutate(response_range = list(get_range(response))) %>%
    unnest() %>%
    mutate(control_range = list(get_range(control))) %>%
    unnest() %>%
    filter(response <= upper &
              response >= lower,
           control <= upper1 & control >= lower1) %>%
    ungroup() %>%
    select(c(ID, experimental_replicate, repeats, response, control))
   
 #  Using the model to estimate the EC50DC
 boscalid.cristian.filtered. <- boscalid.data.cristian.2 %>%
   group_by(ID) %>%
   summarise(
     mean_response = mean(response, na.rm = TRUE),
     mean_control = mean(control, na.rm = TRUE)
   ) %>%
   mutate(RG = (mean_response / mean_control) * 100) %>%
   
   mutate(Estimate.50DC = exp # exponential is the opposite of log
          #using the model the intercept and the coefficient of the model
          (finalRG0.2[[1]][[1]] + finalRG0.2[[1]][[2]] * RG)) %>% ungroup() %>%
   rename(EC50DC = Estimate.50DC) %>%
   mutate(ID = as.numeric(ID)) %>%
   select(c(ID, EC50DC)) %>%
   mutate(new = ifelse(ID %in% boscalid.filtered.survey.yes,
                       "Yes", "No")) #%>%
 #mutate(new= as.factor(new))
  
 #Selecting the EC50D from the serial dilution
 boscalid.complete.cristian <- final.boscalid.DC %>% 
   ####WATCH OUT, Based on EC50DC
   rename(EC50DC = Estimate.50DC) %>% 
   select(ID, EC50DC) %>% 
   bind_rows(boscalid.filtered.2 ) %>% 
   mutate(new= as.character(new)) %>% 
   bind_rows(boscalid.cristian.filtered. ) %>% 
   mutate(new= as.factor(new)) %>% 
   ungroup()
 
 boscalid.complete.cristian
```
##  Testing controls

```{r Testing controls in Boscalid, echo = FALSE, include=FALSE, warning= FALSE}
## Testing controls between Serial dilution and Duscriminatory concentration
 
 boscalid.controls.cristian <- boscalid.complete.cristian$ID[duplicated(boscalid.complete.cristian$ID)]
 # 25 repeats
 
 boscalid.complete.controls.cristian <- boscalid.complete.cristian %>% 
   mutate(controls = ifelse(
     ID %in% boscalid.controls.cristian,
     "Yes", "No")) %>% 
   filter(controls== "Yes")
 
 ## Normality test
 
 shapiro.test.boscal.controls.cristian <- boscalid.complete.controls.cristian  %>%
   do(tidy(shapiro.test(.$EC50DC)))
 
 shapiro.test.boscal.controls.cristian
 
 
 # All normals, t- test since the sample size for each sample is 2, in other words grouping by ID
  # P value = 0.0526
 tested.bocalid.controls.cristian <- boscalid.complete.controls.cristian %>% 
   group_by(ID) %>% 
   do(tidy(t.test(.$EC50DC))) %>% 
   filter(p.value<= 0.05)
 
 tested.bocalid.controls.cristian
 461 %in%tested.bocalid.controls.cristian$ID
 baseline_isolates %in% tested.bocalid.controls.cristian$ID
 # there are 6 isolates different but anyone is 
 # the ID 461 (ccurrent ontrol)  so that is good
 ##From the 21 baseline, there are 2 that are statistically differenet
 
```
## Normality, p value = `r shapiro.test.boscal.controls.cristian[[2]][[1]]`  
there are 6 isolates different but anyone is the ID 461 (ccurrent ontrol),  so that is good  
From the 21 baseline, there are 2 that are statistically different
## Wrangling data in Boscalid
```{r Wrangling data in Boscalid, echo = FALSE, warning= FALSE}
# keeping juts the highest value of the repeated ID value
 boscalid.complete.cristian<- boscalid.complete.cristian%>%  
   mutate( ID= as.numeric(ID)) %>% 
   group_by(ID) %>%
   top_n(1, EC50DC) %>% #keeping the highest value of each ID value
   ungroup() 
 #Filterring specific fields by field scale
 boscalid.complete.cris <- boscalid.complete.cristian%>% 
   mutate(source = ifelse(
     ID %in% baseline_isolates_2,
     "Baseline",
     ifelse(
       ID %in% Farmer_fields,
       "Producer Fields","Fungicide Field Trials"
     )), Host = ifelse(
       ID %in% drybean,
       "Drybean", ifelse(
         ID %in% soybean,
         "Soybean","different_host")),
     Field = ifelse(
       ID %in% MI_East_Lansing,
       "MI:East Lansing",
       ifelse(
         ID %in% IA_Nashua,
         "IA:Nashua",
         ifelse(
           ID %in% WI_Hancock,
           "WI:Hancock",
           ifelse(
             ID %in% MI_Montcalm_2017,
             "MI:Montcalm 2",
             ifelse(
               ID %in% MI_Montcalm_2015,
               "MI: Montcalm 1",
               ifelse(ID %in% potato, 
                      "potato", ifelse(ID %in% baseline_isolates_2, 
                                       "Baseline","other_fields"
                                       
                      )
               )
             )
           )
         )
       )
     )
   )%>%
   mutate(
     source = as.factor(source),
     Host = as.factor(Host),
     Field = as.factor(Field)
   ) %>%    
   #taking out "different host" becuse does not belong to drybean nor soybean
   filter(!ID == 8, !ID == 129)%>%
   mutate(Country = ifelse(
     ID %in% mexican.isolates,
     "Mexico",
     ifelse(ID %in% brazilian.isolates,
            "Brazil", "USA")
   )) 
 
 boscalid.complete.cris <-  boscalid.complete.cris %>% 
   mutate(Year_Field= case_when(
     ID %in%WM_1963~"1963",
     ID %in%WM_1965~"1965",
     ID %in%WM_1969~"1969",
     ID %in%WM_1973~"1973",
     ID %in%WM_1974~"1974",
     ID %in%WM_1975~"1975",
     ID %in%WM_1976~"1976",
     ID %in%WM_1977~"1977",
     ID %in%WM_1978~"1978",
     ID %in%WM_1979~"1979",
     ID %in%WM_1980~"1980",
     ID %in%WM_1981~"1981",
     ID %in%WM_1982~"1982",
     ID %in%WM_1983~"1983",
     ID %in%WM_1984~"1984",
     ID %in%WM_1985~"1985",
     ID %in%WM_1987~"1987",
     ID %in%WM_1989~"1989",
     ID %in%WM_1990~"1990",
     ID %in%WM_1991~"1991",
     ID %in%WM_1992~"1992",
     ID %in%WM_1993~"1993",
     ID %in%WM_1994~"1994",
     ID %in%WM_1995~"1995",
     ID %in%WM_1996~"1996",
     ID %in%WM_1997~"1997",
     ID %in%WM_1997_WM_production_31~"1997_production_31",
     ID %in%WM_1997_WM_production_32~"1997_production_32",
     ID %in%WM_1988~"1988",
     ID %in%WM_1998~"1998",
     ID %in%WM_1999~"1999",
     ID %in%WM_2000~"2000",
     ID %in%WM_2002~"2002",
     ID %in%WM_2003~"2003",
     ID %in%WM_1997_WM_production_33~"1997_production_33",
     ID %in%WM_2003_WM_nursery_1~"2003_nursery_1",
     ID %in%WM_2003_WM_nursery_2~"2003_nursery_2",
     ID %in%WM_2003_WM_nursery_3~"2003_nursery_3",
     ID %in%WM_1996_WM_nursery_4~"1996_nursery_4",
     ID %in%WM_2003_WM_nursery_5~"2003_nursery_5",
     ID %in%WM_2004~"2004",
     ID %in%WM_2005~"2005",
     ID %in%WM_2006~"2006",
     ID %in%WM_2004_WM_nursery_6~"2004_nursery_6",
     ID %in%WM_2004_WM_nursery_7~"2004_nursery_7",
     ID %in%WM_2004_WM_nursery_8~"2004_nursery_8",
     ID %in%WM_2004_WM_nursery_9~"2004_nursery_9",
     ID %in%WM_2004_WM_nursery_10~"2004_nursery_10",
     ID %in%WM_2004_WM_nursery_11~"2004_nursery_11",
     ID %in%WM_2004_WM_nursery_12~"2004_nursery_12",
     ID %in%WM_2005_WM_nursery_13~"2005_nursery_13",
     ID %in%WM_2005_WM_nursery_14~"2005_nursery_14",
     ID %in%WM_2005_WM_nursery_15~"2005_nursery_15",
     ID %in%WM_2005_WM_nursery_16~"2005_nursery_16",
     ID %in%WM_2005_WM_nursery_17~"2005_nursery_17",
     ID %in%WM_2005_WM_nursery_18~"2005_nursery_18",
     ID %in%WM_2006_WM_nursery_19~"2006_nursery_19",
     ID %in%WM_2007~"2007",
     ID %in%WM_2007_WM_production_1~"2007_production_1",
     ID %in%WM_2007_WM_production_2~"2007_production_2",
     ID %in%WM_2007_WM_production_3~"2007_production_3",
     ID %in%WM_2007_WM_production_4~"2007_production_4",
     ID %in%WM_2007_WM_production_5~"2007_production_5",
     ID %in%WM_2007_WM_production_6~"2007_production_6",
     ID %in%WM_2007_WM_production_7~"2007_production_7",
     ID %in%WM_2007_WM_production_8~"2007_production_8",
     ID %in%WM_2007_WM_production_9~"2007_production_9",
     ID %in%WM_2008~"2008",
     ID %in%WM_2008_WM_production_10~"2008_production_10",
     ID %in%WM_2008_WM_nursery_20~"2008_nursery_20",
     ID %in%WM_2008_WM_production_11~"2008_production_11",
     ID %in%WM_2008_WM_production_12~"2008_production_12",
     ID %in%WM_2008_WM_production_13~"2008_production_13",
     ID %in%WM_2009~"2009",
     ID %in%WM_2008_WM_nursery_21~"2008_nursery_21",
     ID %in%WM_2009_WM_nursery_22~"2009_nursery_22",
     ID %in%WM_2009_WM_nursery_23~"2009_nursery_23",
     ID %in%WM_2009_WM_production_14~"2009_production_14",
     ID %in%WM_2009_WM_production_15~"2009_production_15",
     ID %in%WM_2009_WM_production_16~"2009_production_16",
     ID %in%WM_2009_WM_production_17~"2009_production_17",
     ID %in%WM_2009_WM_production_18~"2009_production_18",
     ID %in%WM_2009_WM_production_19~"2009_production_19",
     ID %in%WM_2009_WM_production_20~"2009_production_20",
     ID %in%WM_2010_WM_production_21~"2010_production_21",
     ID %in%WM_2010_WM_production_22~"2010_production_22",
     ID %in%WM_2010_WM_production_23~"2010_production_23",
     ID %in%WM_2010_WM_production_24~"2010_production_24",
     ID %in%WM_2010_WM_production_25~"2010_production_25",
     ID %in%WM_2010_WM_production_26~"2010_production_26",
     ID %in%WM_2010_WM_production_27~"2010_production_27",
     ID %in%WM_2010_WM_production_28~"2010_production_28",
     ID %in%WM_2010_WM_production_29~"2010_production_29",
     ID %in%WM_2010_WM_production_30~"2010_production_30",
     ID %in%WM_2011~"2011",
     ID %in%WM_2013~"2013",
     ID %in%WM_2014~"2014",
     ID %in%WM_2016~"2016",
     ID %in%WM_2016_po~"2016_po",
     ID %in%WM_2016_flo~"2016_flo",
     ID %in%WM_2016_lan~"2016_lan",
     ID %in%WM_2017_ho~"2017_ho",
     ID %in%WM_2017_an~"2017_an",
     ID %in%WM_2017_dod~"2017_dod",
     ID %in%WM_2017_va~"2017_va",
     ID %in%WM_2017_na~"2017_na",
     ID %in%WM_2017_sa~"2017_sa",
     ID %in%WM_2017_ha~"2017_ha",
     ID %in%WM_2017_cu~"2017_cu",
     ID %in%WM_2017_mon~"2017_mon",
     ID %in%WM_2017_ant~"2017_ant",
     ID %in%WM_2017_holt~"2017_holt",
     ID %in%WM_2017_arr~"2017_arr",
     ID %in%WM_2017_ini~"2017_ini",
     ID %in%WM_2017_ley~"2017_ley",
     ID %in%WM_2017_pre~"2017_pre",
     ID %in%WM_2017_ru~"2017_ru",
     ID %in%WM_2017_ca~"2017_ca",
     ID %in%WM_2017_st~"2017_st",
     ID %in%WM_2015_6~"2015_6",
     ID %in%WM_2015_8~"2015_8",
     ID %in%WM_2015_9~"2015_9",
     ID %in%WM_2015_10~"2015_10",
     ID %in%WM_2015_11~"2015_11",
     ID %in%WM_2015_18~"2015_18",
     ID %in%WM_2015_19~"2015_19",
     ID %in%WM_2015_20~"2015_20",
     ID %in%WM_2015_21~"2015_21",
     ID %in%WM_2015_22~"2015_22",
     ID %in%WM_2015_23~"2015_23",
     ID %in%WM_2015_24~"2015_24",
     ID %in%WM_2015_25~"2015_25",
     ID %in%WM_2015_34~"2015_34",
     ID %in%WM_2015_35~"2015_35",
     ID %in%WM_2015_45~"2015_45",
     ID %in%WM_2015_46~"2015_46",
     ID %in%WM_2015_47~"2015_47",
     ID %in%WM_2015_48~"2015_48",
     ID %in%WM_2015_60~"2015_60",
     ID %in%WM_2015_62~"2015_62",
     ID %in%WM_2015_66~"2015_66",
     ID %in%WM_2015_67~"2015_67",
     ID %in%WM_2015_68~"2015_68",
     ID %in%WM_2015_69~"2015_69",
     ID %in%WM_2015_75~"2015_75",
     ID %in%WM_2015_78~"2015_78",
     ID %in%WM_2015_97~"2015_97",
     ID %in%WM_2015_98~"2015_98",
     ID %in%WM_2015_99~"2015_99",
     ID %in%WM_2015_100~"2015_100",
     ID %in%WM_2015_101~"2015_101",
     ID %in%WM_2015_102~"2015_102",
     ID %in%WM_2015_103~"2015_103",
     ID %in%WM_2015_104~"2015_104",
     ID %in%WM_2015_Al~"2015_Al",
     ID %in%WM_2015_Hi~"2015_Hi",
     ID %in%WM_2015_In~"2015_In",
     ID %in%WM_2015_mont~"2015_mont",
     ID %in%WM_2015_Sand~"2015_Sand",
     ID %in%WM_2015_Sani~"2015_Sani",
     ID %in%WM_2015_St~"2015_St",
     ID %in%WM_2015_wau~"2015_wau",
     ID %in%WM_2015_la~"2015_la",
     ID %in%WM_2015_co~"2015_co",
     ID %in%WM_2015_cern~"2015_cern",
     ID %in%WM_2015_cer~"2015_cer",
     ID %in%WM_2010~"2010",
     ID %in%WM_2017~"2017",
     TRUE ~ "no specific field"
   ),
   State= case_when(
     ID %in%WM_AB~"AB",
     ID %in%WM_AZ~"AZ",
     ID %in%WM_BA~"BA",
     ID %in%WM_CA~"CA",
     ID %in%WM_CO~"CO",
     ID %in%WM_DE~"DE",
     ID %in%WM_DF~"DF",
     ID %in%WM_FL~"FL",
     ID %in%WM_GA~"GA",
     ID %in%WM_GO~"GO",
     
     ID %in%WM_IA~"IA",
     ID %in%WM_ID~"ID",
     ID %in%WM_KS~"KS",
     ID %in%WM_KY~"KY",
     ID %in%WM_LA~"LA",
     ID %in%WM_MD~"MD",
     ID %in%WM_MG~"MG",
     ID %in%WM_MI~"MI",
     ID %in%WM_MN~"MN",
     ID %in%WM_MO~"MO",
     
     ID %in%WM_MS~"MS",
     ID %in%WM_MT~"MT",
     ID %in%WM_NC~"NC",
     ID %in%WM_ND~"ND",
     ID %in%WM_NE~"NE",
     ID %in%WM_NY~"NY",
     ID %in%WM_OH~"OH",
     ID %in%WM_OK~"OK",
     ID %in%WM_ON~"ON",
     ID %in%WM_OR~"OR",
     
     ID %in%WM_PA~"PA",
     ID %in%WM_PR~"PR",
     ID %in%WM_QUE~"QUE",
     ID %in%WM_RS~"RS",
     ID %in%WM_SC~"SC",
     ID %in%WM_SIN~"SIN",
     ID %in%WM_SK~"SK",
     ID %in%WM_WI~"WI",
     ID %in%WM_WA~"WA"
     
   )
   ) %>% select(-c(new)) %>% 
   mutate(Country = as.factor(Country),
          Year_Field = as.factor(Year_Field),
          State= as.factor(State) ) %>% 
   arrange(ID)
 
 
 
 
 ###For comparisons between hosts I had to take out the ones coming from baseline otherwise would not be fair
 
 boscalid.complete.host <- boscalid.complete %>% 
   filter(!source=="Baseline")
 
 ###For isolates from that have reduced sensitivity, assess sensitivity for isolates in the same field to account for heterogeneicity
 
 
 
 boscalid.complete.fields.cristian <- boscalid.complete.cris%>% 
   filter(  Field== "Baseline"|
            State== "CO"|
            State== "NE"|
              State== "ND"| 
              State== "WA"|
              State== "MI"
              ) %>% 
   arrange(source) %>% 
   filter( !source == "Fungicide Field Trials") %>% 
   
    mutate(State= as.character(State), 
      State =  ifelse(Field == "Baseline", "Baseline", State),
      State = as.factor(State)) %>% 
   filter(Year_Field == "2007_production_1"|
            Year_Field == "2007_production_2"|
            Year_Field == "2007_production_3"|
            Year_Field == "2007_production_4"|
            Year_Field == "2007_production_5"|
            Year_Field == "2007_production_6"|
            Year_Field == "2007_production_7"|
            Year_Field == "2007_production_8"|
            Year_Field == "2007_production_9"|
            Year_Field == "2008_production_10"|
            Year_Field == "2008_production_11"|
            Year_Field == "2008_production_12"|
            Year_Field == "2008_production_13"|
            Year_Field == "2009_production_17"|
            Year_Field == "2009_production_19"|
            Year_Field == "2009_production_20"|
            Year_Field == "2010_production_21"|
            Year_Field == "2007_production_22"|
            Year_Field == "2007_production_23"|
            Year_Field == "2007_production_24"|
            Year_Field == "2007_production_25"|
            Year_Field == "2007_production_26"|
            Year_Field == "2007_production_27"|
            Year_Field == "2007_production_28"|
            Year_Field == "2007_production_29"|
            Year_Field == "2007_production_30"|
             State == "Baseline")
 # total 124 isolates
 ###
 # boscalid.complete.2 <- boscalid.complete%>% 
 #   filter( !Field == "potato", !Field == "other_fields")
 # 
 # boscalid.complete.3 <- boscalid.complete%>%
 #   filter(
 #     !Country =="Brazil" & !Country == "Mexico"  
 #   )
 
 boscalid.complete.fields.cristian$State <-
   factor(boscalid.complete.fields.cristian$State,
          c("Baseline", "WA", "ND", "MI","CO", "NE"))
 
```

## Statistical analysis  
### By Field (previous Source) but because the name actually is "State"

```{r Normality in Boscalid, include= FALSE}

 ##NORMALITY TEST-Shapiro_test
 
 shapiro.test.boscal.cristian <- boscalid.complete.fields.cristian %>%
   do(tidy(shapiro.test(.$EC50DC)))
 shapiro.test.boscal.cristian[[2]][[1]]
 # p value = 6.402496e-07, No normals
 
```
## No normality, p value = `r shapiro.test.boscal.cristian[[2]][[1]]`    

## kruskal Wallis test

```{r kruskal wallis in Boscalid, echo = FALSE, include=FALSE, warning= FALSE}
object.1.cristian <- kruskal.test(EC50DC ~ State, data = boscalid.complete.fields.cristian)
 object.1.cristian[[3]][[1]]
 
 #There is difference p-value = 1.496384e-07
 
```
## There is difference,  p value =  `r object.1.cristian[[3]][[1]]`  
## Dunn test

```{r Dunn test in Boscalid, echo= FALSE}
object.2.cristian <-  DunnTest(EC50DC ~ State, data = boscalid.complete.fields.cristian, method = "bonferroni")
object.2.cristian 
#  Dunn's test of multiple comparisons using rank sums : bonferroni  
# 
#             mean.rank.diff    pval    
# WA-Baseline     -13.464286 1.00000    
# ND-Baseline     -32.937888 0.03591 *  
# MI-Baseline     -34.824176 0.09058 .  
# CO-Baseline     -46.785714 0.00046 ***
# NE-Baseline     -61.601504 9.3e-07 ***
# ND-WA           -19.473602 0.81262    
# MI-WA           -21.359890 1.00000    
# CO-WA           -33.321429 0.02312 *  
# NE-WA           -48.137218 9.9e-05 ***
# MI-ND            -1.886288 1.00000    
# CO-ND           -13.847826 1.00000    
# NE-ND           -28.663616 0.15141    
# CO-MI           -11.961538 1.00000    
# NE-MI           -26.777328 0.57682    
# NE-CO           -14.815789 1.00000    
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# 
 
```
There is difference  

##  Plot
```{r Plot in Boscalid, echo = FALSE, include=FALSE, warning= FALSE}
 plot.bos.3.cristian <- boscalid.complete.fields.cristian %>%
   ggplot(aes(x = State, y = EC50DC)) +
   geom_jitter(
     width = .1,
     height = 0,
     shape = 21,
     color = "black",
     fill = "chartreuse2",
     size = 2,
     alpha = 3 / 4
   ) + stat_summary(
     fun.y = mean,
     geom = "point",
     shape = 95,
     size = 15,
     color = "black"
   ) +
   labs(x = "State", y = expression(bold(EC[bold("50") ~ (bold("D"))]) ~
                                      (bold(ppm ~ bold(
                                        "a.i."
                                      ))))) + theme(
                                        panel.border = element_rect(
                                          colour = "black",
                                          fill = NA,
                                          size = 1
                                        ),
                                        axis.title = element_text(size = 10, face = "bold", hjust = 0.5),
                                        axis.text = element_text(
                                          face = "bold",
                                          size = 10,
                                          family = "Arial"
                                        ),
                                        panel.background = element_rect(fill = "white", colour = "grey50")
                                      ) +  expand_limits(y = c(0.06, 0.18)) + scale_y_continuous(breaks = c(0.06, 0.08, 0.1, 0.12, 0.14, 0.16, 0.18))
 
 

```

```{r}
plot.bos.3.cristian
```

# Picoxystrobin 
## Reading the data
```{r read data Picoxystrobin, echo = FALSE, include=FALSE}

 glimpse(picoxystrobin.data.cristian)
```
## Discriminatory concentration in Picoxystrobin
```{r Using the DC Picoxystrobin and the model, echo = FALSE, warning=  FALSE}
 
  # Using the function to take out outliers
  picoxystrobin.data.cristian.2 <- picoxystrobin.data.cristian %>%
     rename(response = picoxystrobin.growth, control = sham.growth) %>% 
     group_by(ID) %>%
     mutate(response_range = list(get_range(response))) %>%
     unnest() %>%
     mutate(control_range = list(get_range(control))) %>%
     unnest() %>%
     filter(response <= upper &
               response >= lower,
            control <= upper1 & control >= lower1) %>%
     ungroup() %>%
     select(c(ID, experimental_replicate, repeats, response, control))
  
 
 

 #  Using the model to estimate the EC50DC
 picoxystrobin.cristian.filtered. <-picoxystrobin.data.cristian.2%>%
   group_by(ID) %>%
   summarise(
     mean_response = mean(response, na.rm = TRUE),
     mean_control = mean(control, na.rm = TRUE)
   ) %>%
   mutate(RG = (mean_response / mean_control) * 100) %>%
   
   mutate(Estimate.50DC = exp # exponential is the opposite of log
          #using the model the intercept and the coefficient of the model
          (finalRG0.01[[1]][[1]] + finalRG0.01[[1]][[2]] * RG)) %>%
   ungroup() %>%
   rename(EC50DC= Estimate.50DC) %>% 
   mutate(ID = as.numeric(ID)) %>%
   select(c(ID, EC50DC)) %>% 
   mutate(new = ifelse(
     ID %in% picoxystrobin.filtered.survey.yes,
     "Yes","No")) 
 
 #Selecting the EC50D from the serial dilution
 picoxystrobin.complete.cristian <- final.picoxystrobin.DC %>% 
   ####WATCH OUT, Based on EC50DC
   rename(EC50DC = Estimate.50DC) %>% 
   select(ID, EC50DC) %>% 
   bind_rows(picoxystrobin.filtered. ) %>% 
   #mutate(new= as.character(new)) %>% 
   bind_rows(picoxystrobin.cristian.filtered. ) %>% # HEREIS THE BUG, it was coming from alreday less data
   mutate(new= as.factor(new)) %>% 
   ungroup()
 
 picoxystrobin.complete.cristian
```
##  Testing controls

```{r Testing controls in Picoxystrobin, echo = FALSE, include=FALSE, warning= FALSE}
 ## Testing controls between Serial dilution and Duscriminatory concentration
 
 picoxystrobin.controls.cristian <- picoxystrobin.complete.cristian$ID[duplicated(picoxystrobin.complete.cristian$ID)]
 # 24 repeats
 
 picoxystrobin.complete.controls.cristian <- picoxystrobin.complete.cristian %>% 
    mutate(controls = ifelse(
       ID %in% picoxystrobin.controls.cristian,
       "Yes", "No")) %>% 
    filter(controls== "Yes")
 
 ## Normality test
 
 shapiro.test.pico.controls.cristian <- picoxystrobin.complete.controls.cristian  %>%
    do(tidy(shapiro.test(.$EC50DC)))
 
 shapiro.test.pico.controls.cristian
 
 # ther are NO Normal
 # No normals, t- test since the sample size for each sampe is 2, in other words grouping by ID
 # P value = 0.0323
 tested.pico.controls.cristian <- picoxystrobin.complete.controls.cristian %>% 
    group_by(ID) 
    
    object.3.cristian <- kruskal.test(EC50DC ~ ID, data = picoxystrobin.complete.controls.cristian)
 object.3.cristian[[3]][[1]]
 # P value = 0.05813198, 
 
  # there are no isolates different neither 
 #  the ID 461 (control), good
 # neither From the 21 baseline isolates, good!

```
### No Normality, p value = `r shapiro.test.pico.controls.cristian[[2]][[1]]`  
### Kruskal wallis test, p value = `r object.3.cristian[[3]][[1]]`  
there are no isolates different, neither the ID 461 (control), good!  
neither From the 21 baseline isolates, good!  
## Wrangling data 
```{r Wrangling data in Picoxystrobin, echo = FALSE, warning= FALSE}
# keeping juts the highest value of the repeated ID value
 picoxystrobin.complete.cristian<-picoxystrobin.complete.cristian%>%  
   mutate( ID= as.numeric(ID)) %>% 
   group_by(ID) %>%
   top_n(1, EC50DC) %>% #keeping the highest value of each ID value
   ungroup() 
 #Filterring specific fields by field scale
 picoxystrobin.complete.cris <-picoxystrobin.complete.cristian%>% 
   mutate(source = ifelse(
     ID %in% baseline_isolates_2,
     "Baseline",
     ifelse(
       ID %in% Farmer_fields,
       "Producer Fields","Fungicide Field Trials"
     )), Host = ifelse(
       ID %in% drybean,
       "Drybean", ifelse(
         ID %in% soybean,
         "Soybean","different_host")),
     Field = ifelse(
       ID %in% MI_East_Lansing,
       "MI:East Lansing",
       ifelse(
         ID %in% IA_Nashua,
         "IA:Nashua",
         ifelse(
           ID %in% WI_Hancock,
           "WI:Hancock",
           ifelse(
             ID %in% MI_Montcalm_2017,
             "MI:Montcalm 2",
             ifelse(
               ID %in% MI_Montcalm_2015,
               "MI: Montcalm 1",
               ifelse(
                 ID %in% WI_Cerny,
                 "WI:Cerny",
               ifelse(ID %in% potato, 
                      "potato", ifelse(ID %in% baseline_isolates_2, 
                                       "Baseline","other_fields"
                      )                 
                      )
               )
             )
           )
         )
       )
     )
   )%>%
   mutate(
     source = as.factor(source),
     Host = as.factor(Host),
     Field = as.factor(Field)
   ) %>%    
   #taking out "different host" becuse does not belong to drybean nor soybean
   filter(!ID == 8, !ID == 129)%>%
   mutate(Country = ifelse(
     ID %in% mexican.isolates,
     "Mexico",
     ifelse(ID %in% brazilian.isolates,
            "Brazil", "USA")
   )) 
 
 picoxystrobin.complete.cris <- picoxystrobin.complete.cris %>% 
   mutate(Year_Field= case_when(
     ID %in%WM_1963~"1963",
     ID %in%WM_1965~"1965",
     ID %in%WM_1969~"1969",
     ID %in%WM_1973~"1973",
     ID %in%WM_1974~"1974",
     ID %in%WM_1975~"1975",
     ID %in%WM_1976~"1976",
     ID %in%WM_1977~"1977",
     ID %in%WM_1978~"1978",
     ID %in%WM_1979~"1979",
     ID %in%WM_1980~"1980",
     ID %in%WM_1981~"1981",
     ID %in%WM_1982~"1982",
     ID %in%WM_1983~"1983",
     ID %in%WM_1984~"1984",
     ID %in%WM_1985~"1985",
     ID %in%WM_1987~"1987",
     ID %in%WM_1989~"1989",
     ID %in%WM_1990~"1990",
     ID %in%WM_1991~"1991",
     ID %in%WM_1992~"1992",
     ID %in%WM_1993~"1993",
     ID %in%WM_1994~"1994",
     ID %in%WM_1995~"1995",
     ID %in%WM_1996~"1996",
     ID %in%WM_1997~"1997",
     ID %in%WM_1997_WM_production_31~"1997_production_31",
     ID %in%WM_1997_WM_production_32~"1997_production_32",
     ID %in%WM_1988~"1988",
     ID %in%WM_1998~"1998",
     ID %in%WM_1999~"1999",
     ID %in%WM_2000~"2000",
     ID %in%WM_2002~"2002",
     ID %in%WM_2003~"2003",
     ID %in%WM_1997_WM_production_33~"1997_production_33",
     ID %in%WM_2003_WM_nursery_1~"2003_nursery_1",
     ID %in%WM_2003_WM_nursery_2~"2003_nursery_2",
     ID %in%WM_2003_WM_nursery_3~"2003_nursery_3",
     ID %in%WM_1996_WM_nursery_4~"1996_nursery_4",
     ID %in%WM_2003_WM_nursery_5~"2003_nursery_5",
     ID %in%WM_2004~"2004",
     ID %in%WM_2005~"2005",
     ID %in%WM_2006~"2006",
     ID %in%WM_2004_WM_nursery_6~"2004_nursery_6",
     ID %in%WM_2004_WM_nursery_7~"2004_nursery_7",
     ID %in%WM_2004_WM_nursery_8~"2004_nursery_8",
     ID %in%WM_2004_WM_nursery_9~"2004_nursery_9",
     ID %in%WM_2004_WM_nursery_10~"2004_nursery_10",
     ID %in%WM_2004_WM_nursery_11~"2004_nursery_11",
     ID %in%WM_2004_WM_nursery_12~"2004_nursery_12",
     ID %in%WM_2005_WM_nursery_13~"2005_nursery_13",
     ID %in%WM_2005_WM_nursery_14~"2005_nursery_14",
     ID %in%WM_2005_WM_nursery_15~"2005_nursery_15",
     ID %in%WM_2005_WM_nursery_16~"2005_nursery_16",
     ID %in%WM_2005_WM_nursery_17~"2005_nursery_17",
     ID %in%WM_2005_WM_nursery_18~"2005_nursery_18",
     ID %in%WM_2006_WM_nursery_19~"2006_nursery_19",
     ID %in%WM_2007~"2007",
     ID %in%WM_2007_WM_production_1~"2007_production_1",
     ID %in%WM_2007_WM_production_2~"2007_production_2",
     ID %in%WM_2007_WM_production_3~"2007_production_3",
     ID %in%WM_2007_WM_production_4~"2007_production_4",
     ID %in%WM_2007_WM_production_5~"2007_production_5",
     ID %in%WM_2007_WM_production_6~"2007_production_6",
     ID %in%WM_2007_WM_production_7~"2007_production_7",
     ID %in%WM_2007_WM_production_8~"2007_production_8",
     ID %in%WM_2007_WM_production_9~"2007_production_9",
     ID %in%WM_2008~"2008",
     ID %in%WM_2008_WM_production_10~"2008_production_10",
     ID %in%WM_2008_WM_nursery_20~"2008_nursery_20",
     ID %in%WM_2008_WM_production_11~"2008_production_11",
     ID %in%WM_2008_WM_production_12~"2008_production_12",
     ID %in%WM_2008_WM_production_13~"2008_production_13",
     ID %in%WM_2009~"2009",
     ID %in%WM_2008_WM_nursery_21~"2008_nursery_21",
     ID %in%WM_2009_WM_nursery_22~"2009_nursery_22",
     ID %in%WM_2009_WM_nursery_23~"2009_nursery_23",
     ID %in%WM_2009_WM_production_14~"2009_production_14",
     ID %in%WM_2009_WM_production_15~"2009_production_15",
     ID %in%WM_2009_WM_production_16~"2009_production_16",
     ID %in%WM_2009_WM_production_17~"2009_production_17",
     ID %in%WM_2009_WM_production_18~"2009_production_18",
     ID %in%WM_2009_WM_production_19~"2009_production_19",
     ID %in%WM_2009_WM_production_20~"2009_production_20",
     ID %in%WM_2010_WM_production_21~"2010_production_21",
     ID %in%WM_2010_WM_production_22~"2010_production_22",
     ID %in%WM_2010_WM_production_23~"2010_production_23",
     ID %in%WM_2010_WM_production_24~"2010_production_24",
     ID %in%WM_2010_WM_production_25~"2010_production_25",
     ID %in%WM_2010_WM_production_26~"2010_production_26",
     ID %in%WM_2010_WM_production_27~"2010_production_27",
     ID %in%WM_2010_WM_production_28~"2010_production_28",
     ID %in%WM_2010_WM_production_29~"2010_production_29",
     ID %in%WM_2010_WM_production_30~"2010_production_30",
     ID %in%WM_2011~"2011",
     ID %in%WM_2013~"2013",
     ID %in%WM_2014~"2014",
     ID %in%WM_2016~"2016",
     ID %in%WM_2016_po~"2016_po",
     ID %in%WM_2016_flo~"2016_flo",
     ID %in%WM_2016_lan~"2016_lan",
     ID %in%WM_2017_ho~"2017_ho",
     ID %in%WM_2017_an~"2017_an",
     ID %in%WM_2017_dod~"2017_dod",
     ID %in%WM_2017_va~"2017_va",
     ID %in%WM_2017_na~"2017_na",
     ID %in%WM_2017_sa~"2017_sa",
     ID %in%WM_2017_ha~"2017_ha",
     ID %in%WM_2017_cu~"2017_cu",
     ID %in%WM_2017_mon~"2017_mon",
     ID %in%WM_2017_ant~"2017_ant",
     ID %in%WM_2017_holt~"2017_holt",
     ID %in%WM_2017_arr~"2017_arr",
     ID %in%WM_2017_ini~"2017_ini",
     ID %in%WM_2017_ley~"2017_ley",
     ID %in%WM_2017_pre~"2017_pre",
     ID %in%WM_2017_ru~"2017_ru",
     ID %in%WM_2017_ca~"2017_ca",
     ID %in%WM_2017_st~"2017_st",
     ID %in%WM_2015_6~"2015_6",
     ID %in%WM_2015_8~"2015_8",
     ID %in%WM_2015_9~"2015_9",
     ID %in%WM_2015_10~"2015_10",
     ID %in%WM_2015_11~"2015_11",
     ID %in%WM_2015_18~"2015_18",
     ID %in%WM_2015_19~"2015_19",
     ID %in%WM_2015_20~"2015_20",
     ID %in%WM_2015_21~"2015_21",
     ID %in%WM_2015_22~"2015_22",
     ID %in%WM_2015_23~"2015_23",
     ID %in%WM_2015_24~"2015_24",
     ID %in%WM_2015_25~"2015_25",
     ID %in%WM_2015_34~"2015_34",
     ID %in%WM_2015_35~"2015_35",
     ID %in%WM_2015_45~"2015_45",
     ID %in%WM_2015_46~"2015_46",
     ID %in%WM_2015_47~"2015_47",
     ID %in%WM_2015_48~"2015_48",
     ID %in%WM_2015_60~"2015_60",
     ID %in%WM_2015_62~"2015_62",
     ID %in%WM_2015_66~"2015_66",
     ID %in%WM_2015_67~"2015_67",
     ID %in%WM_2015_68~"2015_68",
     ID %in%WM_2015_69~"2015_69",
     ID %in%WM_2015_75~"2015_75",
     ID %in%WM_2015_78~"2015_78",
     ID %in%WM_2015_97~"2015_97",
     ID %in%WM_2015_98~"2015_98",
     ID %in%WM_2015_99~"2015_99",
     ID %in%WM_2015_100~"2015_100",
     ID %in%WM_2015_101~"2015_101",
     ID %in%WM_2015_102~"2015_102",
     ID %in%WM_2015_103~"2015_103",
     ID %in%WM_2015_104~"2015_104",
     ID %in%WM_2015_Al~"2015_Al",
     ID %in%WM_2015_Hi~"2015_Hi",
     ID %in%WM_2015_In~"2015_In",
     ID %in%WM_2015_mont~"2015_mont",
     ID %in%WM_2015_Sand~"2015_Sand",
     ID %in%WM_2015_Sani~"2015_Sani",
     ID %in%WM_2015_St~"2015_St",
     ID %in%WM_2015_wau~"2015_wau",
     ID %in%WM_2015_la~"2015_la",
     ID %in%WM_2015_co~"2015_co",
     ID %in%WM_2015_cern~"2015_cern",
     ID %in%WM_2015_cer~"2015_cer",
     ID %in%WM_2010~"2010",
     ID %in%WM_2017~"2017",
     TRUE ~ "no specific field"
   ),
   State= case_when(
     ID %in%WM_AB~"AB",
     ID %in%WM_AZ~"AZ",
     ID %in%WM_BA~"BA",
     ID %in%WM_CA~"CA",
     ID %in%WM_CO~"CO",
     ID %in%WM_DE~"DE",
     ID %in%WM_DF~"DF",
     ID %in%WM_FL~"FL",
     ID %in%WM_GA~"GA",
     ID %in%WM_GO~"GO",
     
     ID %in%WM_IA~"IA",
     ID %in%WM_ID~"ID",
     ID %in%WM_KS~"KS",
     ID %in%WM_KY~"KY",
     ID %in%WM_LA~"LA",
     ID %in%WM_MD~"MD",
     ID %in%WM_MG~"MG",
     ID %in%WM_MI~"MI",
     ID %in%WM_MN~"MN",
     ID %in%WM_MO~"MO",
     
     ID %in%WM_MS~"MS",
     ID %in%WM_MT~"MT",
     ID %in%WM_NC~"NC",
     ID %in%WM_ND~"ND",
     ID %in%WM_NE~"NE",
     ID %in%WM_NY~"NY",
     ID %in%WM_OH~"OH",
     ID %in%WM_OK~"OK",
     ID %in%WM_ON~"ON",
     ID %in%WM_OR~"OR",
     
     ID %in%WM_PA~"PA",
     ID %in%WM_PR~"PR",
     ID %in%WM_QUE~"QUE",
     ID %in%WM_RS~"RS",
     ID %in%WM_SC~"SC",
     ID %in%WM_SIN~"SIN",
     ID %in%WM_SK~"SK",
     ID %in%WM_WI~"WI",
     ID %in%WM_WA~"WA"
     
   )
   ) %>% select(-c(new)) %>% 
   mutate(Country = as.factor(Country),
          Year_Field = as.factor(Year_Field),
          State= as.factor(State) ) %>% 
   arrange(ID)
 
 ##
 
 ###For comparisons between hosts I had to take out the ones coming from baseline otherwise would not be fair
 
 picoxystrobin.complete.host <-picoxystrobin.complete %>% 
   filter(!source=="Baseline")
 
 ###For isolates from that have reduced sensitivity, assess sensitivity for isolates in the same field to account for heterogeneicity
 ##WITH MEXICO & BRAZIL together
 # picoxystrobin.complete.fields.cristian <-picoxystrobin.complete.cris%>%
 #   filter(  Field== "Baseline"|
 #              State== "CO"|
 #              State== "NE"|
 #              State== "ND"|
 #              State== "WA"|
 #              State== "MI"|
 #              Country== "Mexico"|
 #              Country== "Brazil"
 #   ) %>%
 #   arrange(source) %>%
 #    #
 #   mutate(State= as.character(State),
 #          State =  ifelse(Field == "Baseline", "Baseline", State),
 #          State = as.factor(State)) %>%
 #   filter(Year_Field == "2007_production_1"|
 #            Year_Field == "2007_production_2"|
 #            Year_Field == "2007_production_3"|
 #            Year_Field == "2007_production_4"|
 #            Year_Field == "2007_production_5"|
 #            Year_Field == "2007_production_6"|
 #            Year_Field == "2007_production_7"|
 #            Year_Field == "2007_production_8"|
 #            Year_Field == "2007_production_9"|
 #            Year_Field == "2008_production_10"|
 #            Year_Field == "2008_production_11"|
 #            Year_Field == "2008_production_12"|
 #            Year_Field == "2008_production_13"|
 #            Year_Field == "2009_production_17"|
 #            Year_Field == "2009_production_19"|
 #            Year_Field == "2009_production_20"|
 #            Year_Field == "2010_production_21"|
 #            Year_Field == "2007_production_22"|
 #            Year_Field == "2007_production_23"|
 #            Year_Field == "2007_production_24"|
 #            Year_Field == "2007_production_25"|
 #            Year_Field == "2007_production_26"|
 #            Year_Field == "2007_production_27"|
 #            Year_Field == "2007_production_28"|
 #            Year_Field == "2007_production_29"|
 #            Year_Field == "2007_production_30"|
 #            State == "Baseline"|
 #            Country== "Mexico"|
 #            Country== "Brazil") %>% 
 #           mutate(State = fct_recode(State, "Mexico & Brazil"= "SIN" , "Mexico & Brazil"= "GO", "Mexico & Brazil" = "MG"))
 #          
 # 
 picoxystrobin.complete.fields.cristian <-picoxystrobin.complete.cris%>% 
   filter(  Field== "Baseline"|
              State== "CO"|
              State== "NE"|
              State== "ND"| 
              State== "WA"|
              State== "MI"
              
   ) %>% 
   arrange(source) %>% 
   filter( !source == "Fungicide Field Trials") %>% 
   
   mutate(State= as.character(State), 
          State =  ifelse(Field == "Baseline", "Baseline", State),
          State = as.factor(State)) %>% 
   filter(Year_Field == "2007_production_1"|
            Year_Field == "2007_production_2"|
            Year_Field == "2007_production_3"|
            Year_Field == "2007_production_4"|
            Year_Field == "2007_production_5"|
            Year_Field == "2007_production_6"|
            Year_Field == "2007_production_7"|
            Year_Field == "2007_production_8"|
            Year_Field == "2007_production_9"|
            Year_Field == "2008_production_10"|
            Year_Field == "2008_production_11"|
            Year_Field == "2008_production_12"|
            Year_Field == "2008_production_13"|
            Year_Field == "2009_production_17"|
            Year_Field == "2009_production_19"|
            Year_Field == "2009_production_20"|
            Year_Field == "2010_production_21"|
            Year_Field == "2007_production_22"|
            Year_Field == "2007_production_23"|
            Year_Field == "2007_production_24"|
            Year_Field == "2007_production_25"|
            Year_Field == "2007_production_26"|
            Year_Field == "2007_production_27"|
            Year_Field == "2007_production_28"|
            Year_Field == "2007_production_29"|
            Year_Field == "2007_production_30"|
            State == "Baseline")
 
 # total 125 isolates
 picoxystrobin.complete.fields.cristian$State <-
   factor(picoxystrobin.complete.fields.cristian$State,
          c( "ND","NE","WA","MI","CO", "Baseline"))
 
```

## Statistical analysis
### By Field (previous Source) but because the name actually is "State"

```{r Normality in Picoxystrobin, include= FALSE}

 ##NORMALITY TEST-Shapiro_test
 
 shapiro.test.pico.fields.cristian <-picoxystrobin.complete.fields.cristian %>%
   do(tidy(shapiro.test(.$EC50DC)))
 shapiro.test.pico.fields.cristian 
 # NO NORMALILTY  P value ==0.0179
 # is by Field but it is written State
 
```
## No normality, p value = `r shapiro.test.pico.fields.cristian[[2]][[1]]`     

## By Field (previous Source) but because the nam
## Kruskal Wallis test

```{r kruskal wallis in Picoxystrobin, echo = FALSE, include=FALSE, warning= FALSE}
 object.4.cristian <- kruskal.test(EC50DC ~ State, data = picoxystrobin.complete.fields.cristian)
 object.4.cristian[[3]][[1]]
 
 #There is difference p-value = 7.593402e-05

 
```
## There is difference,  p value =  `r object.4.cristian[[3]][[1]]`    
## Dunn test
```{r Dunn test in Picoxystrobin, echo= FALSE}
object.5.cristian <-  DunnTest(EC50DC ~ State, data = picoxystrobin.complete.fields.cristian, method = "bonferroni")
 object.5.cristian
 
 
#  Dunn's test of multiple comparisons using rank sums : bonferroni  
# 
#             mean.rank.diff    pval    
# NE-ND           -23.890160  0.5012    
# WA-ND           -21.986025  0.4656    
# MI-ND           -25.060201  0.6931    
# CO-ND           -29.421739  0.1185    
# Baseline-ND     -54.839921 5.8e-06 ***
# WA-NE             1.904135  1.0000    
# MI-NE            -1.170040  1.0000    
# CO-NE            -5.531579  1.0000    
# Baseline-NE     -30.949761  0.0957 .  
# MI-WA            -3.074176  1.0000    
# CO-WA            -7.435714  1.0000    
# Baseline-WA     -32.853896  0.0219 *  
# CO-MI            -4.361538  1.0000    
# Baseline-MI     -29.779720  0.2818    
# Baseline-CO     -25.418182  0.3473    
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#  
 
```
There is difference  

## Plot
```{r Plot in Picoxystrobin, echo = FALSE, include=FALSE, warning= FALSE}
 plot.pico.3.cristian <- picoxystrobin.complete.fields.cristian %>%
   ggplot(aes(x = State, y = EC50DC)) +
   geom_jitter(
     width = .1,
     height = 0,
     shape = 21,
     color = "black",
     fill = "chocolate1",
     size = 2,
     alpha = 3 / 4
   ) + stat_summary(
     fun.y = mean,
     geom = "point",
     shape = 95,
     size = 15,
     color = "black"
   ) +
   labs(x = "State", y = expression(bold(EC[bold("50") ~ (bold("D"))]) ~
                                      (bold(ppm ~ bold(
                                        "a.i."
                                      ))))) + theme(
                                        panel.border = element_rect(
                                          colour = "black",
                                          fill = NA,
                                          size = 1
                                        ),
                                        axis.title = element_text(size = 10, face = "bold", hjust = 0.5),
                                        axis.text = element_text(
                                          face = "bold",
                                          size = 10,
                                          family = "Arial"
                                        ),
                                        panel.background = element_rect(fill = "white", colour = "grey50")
                                      ) + scale_y_continuous(breaks = c(0.008, 0.01, 0.012, 0.014, 0.016, 0.018, 0.020,0.022,0.024))
 
 
```

 
```{r}
plot.pico.3.cristian
```
# Tetraconazole
##  Reading the data 
```{r read data Tetraconazole, echo = FALSE, include= FALSE}
glimpse(tetraconazole.data.cristian)
```
## Discriminatory concentration 
```{r Using the DC Tetraconazole and the model, echo = FALSE, warning=  FALSE}
# Using the function to take out outliers
  tetraconazole.data.cristian.2 <- tetraconazole.data.cristian %>%
     rename(response = tetraconazole.growth, control = control.growth) %>% 
     group_by(ID) %>%
     mutate(response_range = list(get_range(response))) %>%
     unnest() %>%
     mutate(control_range = list(get_range(control))) %>%
     unnest() %>%
     filter(response <= upper &
               response >= lower,
            control <= upper1 & control >= lower1) %>%
     ungroup() %>%
     select(c(ID, experimental_replicate, repeats, response, control))
  
  
 
 #  Using the model to estimate the EC50DC
 tetraconazole.cristian.filtered. <-tetraconazole.data.cristian.2 %>%
   group_by(ID) %>%
   summarise(
     mean_response = mean(response, na.rm = TRUE),
     mean_control = mean(control, na.rm = TRUE)
   ) %>%
   mutate(RG = (mean_response / mean_control) * 100) %>%
   
   mutate(Estimate.50DC = exp (finalRG2[[1]][[1]] + finalRG2[[1]][[2]]*RG)) %>%
   ungroup() %>%
   rename(EC50DC= Estimate.50DC) %>% 
   mutate(ID = as.numeric(ID)) %>%
   select(c(ID, EC50DC)) %>% 
   mutate(new = ifelse(
     ID %in% picoxystrobin.filtered.survey.yes,
     "Yes","No")) 
 

```


##  Testing controls
```{r Testing controls in Tetraconazole, echo = FALSE, include=FALSE, warning= FALSE}
#Selecting the EC50D from the serial dilution
 tetraconazole.complete.cristian <- final.tetraconazole.DC %>% 
   ####WATCH OUT, Based on EC50DC
   rename(EC50DC = Estimate.50DC) %>% 
   select(ID, EC50DC) %>% 
   bind_rows(tetraconazole.filtered. ) %>% 
   #mutate(new= as.character(new)) %>% 
   bind_rows(tetraconazole.cristian.filtered. ) %>% 
   mutate(new= as.factor(new)) %>% 
   ungroup()
 
 ## Testing controls between Serial dilution and Duscriminatory concentration
 
 tetraconazole.controls.cristian <- tetraconazole.complete.cristian$ID[duplicated(tetraconazole.complete.cristian$ID)]
 # 24 repeats
 
 tetraconazole.complete.controls.cristian <- tetraconazole.complete.cristian %>% 
    mutate(controls = ifelse(
       ID %in% tetraconazole.controls.cristian,
       "Yes", "No")) %>% 
    filter(controls== "Yes")
 
 ## Normality test
 
 shapiro.test.tetra.controls.cristian <- tetraconazole.complete.controls.cristian  %>%
    do(tidy(shapiro.test(.$EC50DC)))
 
 shapiro.test.tetra.controls.cristian
 
 
 # NO normals, t- test since the sample size for each sampe is 2, in other words grouping by ID
 # P value = 0.000000543
 tested.tetraconazole.controls.cristian <- tetraconazole.complete.controls.cristian %>% 
    group_by(ID) 
 
 object.6.cristian <- kruskal.test(EC50DC ~ ID, data = tested.tetraconazole.controls.cristian)
 object.6.cristian[[3]][[1]]
 
 # There is no difference the P value is = 0.05680849
 
 # the ID 461 (control) is not in here so that is good
 ##From the 21 baseline, there are not statistically differenet
 
```
## No normality, p value = `r shapiro.test.tetra.controls.cristian[[2]][[1]]`  
## Kruskal Wallis, There is no difference,  p value =  `r object.6.cristian[[3]][[1]]`  
there are no isolates different, neither the ID 461 (control), good!    
neither From the 21 baseline isolates, good!  

## Wrangling data
```{r Wrangling data in Tetraconazole, echo = FALSE, warning= FALSE}
# keeping juts the highest value of the repeated ID value
 tetraconazole.complete.cristian<-tetraconazole.complete.cristian%>%  
   mutate( ID= as.numeric(ID)) %>% 
   group_by(ID) %>%
   top_n(1, EC50DC) %>% #keeping the highest value of each ID value
   ungroup() 
 
 
 
 
 #Filterring specific fields by field scale
 tetraconazole.complete.cris <-tetraconazole.complete.cristian%>% 
   mutate(source = ifelse(
     ID %in% baseline_isolates_2,
     "Baseline",
     ifelse(
       ID %in% Farmer_fields,
       "Producer Fields","Fungicide Field Trials"
     )), Host = ifelse(
       ID %in% drybean,
       "Drybean", ifelse(
         ID %in% soybean,
         "Soybean","different_host")),
     Field = ifelse(
       ID %in% NE_Holt,
       "NE_Holt",
       ifelse(
         ID %in% NE_Field_34,
         "NE:Dodge",
         ifelse(
           ID %in% NE_Field_67,
           "NE:Cedar 1",
           ifelse(
             ID %in% NE_Field_75,
             "NE:Antelope",
             ifelse(
               ID %in% NE_Field_97,
               "NE:Pierce",
               ifelse(
                 ID %in% NE_Field_98,
                 "NE:Cedar 3",
                 ifelse(
                   ID %in% NE_Field_101,
                   "NE:Cedar 2",
                   ifelse(ID %in% potato, 
                          "potato", ifelse(ID %in% baseline_isolates_2, 
                                           "Baseline","other_fields"
                                           
                          )))
               )
             )
           )
         )
       )
     )
   )%>%
   mutate(
     source = as.factor(source),
     Host = as.factor(Host),
     Field = as.factor(Field)
   ) %>%    
   #taking out "different host" becuse does not belong to drybean nor soybean
   filter(!ID == 8, !ID == 129)%>%
   mutate(Country = ifelse(
     ID %in% mexican.isolates,
     "Mexico",
     ifelse(ID %in% brazilian.isolates,
            "Brazil", "USA")
   )) 
 
 tetraconazole.complete.cris <- tetraconazole.complete.cris %>% 
   mutate(Year_Field= case_when(
     ID %in%WM_1963~"1963",
     ID %in%WM_1965~"1965",
     ID %in%WM_1969~"1969",
     ID %in%WM_1973~"1973",
     ID %in%WM_1974~"1974",
     ID %in%WM_1975~"1975",
     ID %in%WM_1976~"1976",
     ID %in%WM_1977~"1977",
     ID %in%WM_1978~"1978",
     ID %in%WM_1979~"1979",
     ID %in%WM_1980~"1980",
     ID %in%WM_1981~"1981",
     ID %in%WM_1982~"1982",
     ID %in%WM_1983~"1983",
     ID %in%WM_1984~"1984",
     ID %in%WM_1985~"1985",
     ID %in%WM_1987~"1987",
     ID %in%WM_1989~"1989",
     ID %in%WM_1990~"1990",
     ID %in%WM_1991~"1991",
     ID %in%WM_1992~"1992",
     ID %in%WM_1993~"1993",
     ID %in%WM_1994~"1994",
     ID %in%WM_1995~"1995",
     ID %in%WM_1996~"1996",
     ID %in%WM_1997~"1997",
     ID %in%WM_1997_WM_production_31~"1997_production_31",
     ID %in%WM_1997_WM_production_32~"1997_production_32",
     ID %in%WM_1988~"1988",
     ID %in%WM_1998~"1998",
     ID %in%WM_1999~"1999",
     ID %in%WM_2000~"2000",
     ID %in%WM_2002~"2002",
     ID %in%WM_2003~"2003",
     ID %in%WM_1997_WM_production_33~"1997_production_33",
     ID %in%WM_2003_WM_nursery_1~"2003_nursery_1",
     ID %in%WM_2003_WM_nursery_2~"2003_nursery_2",
     ID %in%WM_2003_WM_nursery_3~"2003_nursery_3",
     ID %in%WM_1996_WM_nursery_4~"1996_nursery_4",
     ID %in%WM_2003_WM_nursery_5~"2003_nursery_5",
     ID %in%WM_2004~"2004",
     ID %in%WM_2005~"2005",
     ID %in%WM_2006~"2006",
     ID %in%WM_2004_WM_nursery_6~"2004_nursery_6",
     ID %in%WM_2004_WM_nursery_7~"2004_nursery_7",
     ID %in%WM_2004_WM_nursery_8~"2004_nursery_8",
     ID %in%WM_2004_WM_nursery_9~"2004_nursery_9",
     ID %in%WM_2004_WM_nursery_10~"2004_nursery_10",
     ID %in%WM_2004_WM_nursery_11~"2004_nursery_11",
     ID %in%WM_2004_WM_nursery_12~"2004_nursery_12",
     ID %in%WM_2005_WM_nursery_13~"2005_nursery_13",
     ID %in%WM_2005_WM_nursery_14~"2005_nursery_14",
     ID %in%WM_2005_WM_nursery_15~"2005_nursery_15",
     ID %in%WM_2005_WM_nursery_16~"2005_nursery_16",
     ID %in%WM_2005_WM_nursery_17~"2005_nursery_17",
     ID %in%WM_2005_WM_nursery_18~"2005_nursery_18",
     ID %in%WM_2006_WM_nursery_19~"2006_nursery_19",
     ID %in%WM_2007~"2007",
     ID %in%WM_2007_WM_production_1~"2007_production_1",
     ID %in%WM_2007_WM_production_2~"2007_production_2",
     ID %in%WM_2007_WM_production_3~"2007_production_3",
     ID %in%WM_2007_WM_production_4~"2007_production_4",
     ID %in%WM_2007_WM_production_5~"2007_production_5",
     ID %in%WM_2007_WM_production_6~"2007_production_6",
     ID %in%WM_2007_WM_production_7~"2007_production_7",
     ID %in%WM_2007_WM_production_8~"2007_production_8",
     ID %in%WM_2007_WM_production_9~"2007_production_9",
     ID %in%WM_2008~"2008",
     ID %in%WM_2008_WM_production_10~"2008_production_10",
     ID %in%WM_2008_WM_nursery_20~"2008_nursery_20",
     ID %in%WM_2008_WM_production_11~"2008_production_11",
     ID %in%WM_2008_WM_production_12~"2008_production_12",
     ID %in%WM_2008_WM_production_13~"2008_production_13",
     ID %in%WM_2009~"2009",
     ID %in%WM_2008_WM_nursery_21~"2008_nursery_21",
     ID %in%WM_2009_WM_nursery_22~"2009_nursery_22",
     ID %in%WM_2009_WM_nursery_23~"2009_nursery_23",
     ID %in%WM_2009_WM_production_14~"2009_production_14",
     ID %in%WM_2009_WM_production_15~"2009_production_15",
     ID %in%WM_2009_WM_production_16~"2009_production_16",
     ID %in%WM_2009_WM_production_17~"2009_production_17",
     ID %in%WM_2009_WM_production_18~"2009_production_18",
     ID %in%WM_2009_WM_production_19~"2009_production_19",
     ID %in%WM_2009_WM_production_20~"2009_production_20",
     ID %in%WM_2010_WM_production_21~"2010_production_21",
     ID %in%WM_2010_WM_production_22~"2010_production_22",
     ID %in%WM_2010_WM_production_23~"2010_production_23",
     ID %in%WM_2010_WM_production_24~"2010_production_24",
     ID %in%WM_2010_WM_production_25~"2010_production_25",
     ID %in%WM_2010_WM_production_26~"2010_production_26",
     ID %in%WM_2010_WM_production_27~"2010_production_27",
     ID %in%WM_2010_WM_production_28~"2010_production_28",
     ID %in%WM_2010_WM_production_29~"2010_production_29",
     ID %in%WM_2010_WM_production_30~"2010_production_30",
     ID %in%WM_2011~"2011",
     ID %in%WM_2013~"2013",
     ID %in%WM_2014~"2014",
     ID %in%WM_2016~"2016",
     ID %in%WM_2016_po~"2016_po",
     ID %in%WM_2016_flo~"2016_flo",
     ID %in%WM_2016_lan~"2016_lan",
     ID %in%WM_2017_ho~"2017_ho",
     ID %in%WM_2017_an~"2017_an",
     ID %in%WM_2017_dod~"2017_dod",
     ID %in%WM_2017_va~"2017_va",
     ID %in%WM_2017_na~"2017_na",
     ID %in%WM_2017_sa~"2017_sa",
     ID %in%WM_2017_ha~"2017_ha",
     ID %in%WM_2017_cu~"2017_cu",
     ID %in%WM_2017_mon~"2017_mon",
     ID %in%WM_2017_ant~"2017_ant",
     ID %in%WM_2017_holt~"2017_holt",
     ID %in%WM_2017_arr~"2017_arr",
     ID %in%WM_2017_ini~"2017_ini",
     ID %in%WM_2017_ley~"2017_ley",
     ID %in%WM_2017_pre~"2017_pre",
     ID %in%WM_2017_ru~"2017_ru",
     ID %in%WM_2017_ca~"2017_ca",
     ID %in%WM_2017_st~"2017_st",
     ID %in%WM_2015_6~"2015_6",
     ID %in%WM_2015_8~"2015_8",
     ID %in%WM_2015_9~"2015_9",
     ID %in%WM_2015_10~"2015_10",
     ID %in%WM_2015_11~"2015_11",
     ID %in%WM_2015_18~"2015_18",
     ID %in%WM_2015_19~"2015_19",
     ID %in%WM_2015_20~"2015_20",
     ID %in%WM_2015_21~"2015_21",
     ID %in%WM_2015_22~"2015_22",
     ID %in%WM_2015_23~"2015_23",
     ID %in%WM_2015_24~"2015_24",
     ID %in%WM_2015_25~"2015_25",
     ID %in%WM_2015_34~"2015_34",
     ID %in%WM_2015_35~"2015_35",
     ID %in%WM_2015_45~"2015_45",
     ID %in%WM_2015_46~"2015_46",
     ID %in%WM_2015_47~"2015_47",
     ID %in%WM_2015_48~"2015_48",
     ID %in%WM_2015_60~"2015_60",
     ID %in%WM_2015_62~"2015_62",
     ID %in%WM_2015_66~"2015_66",
     ID %in%WM_2015_67~"2015_67",
     ID %in%WM_2015_68~"2015_68",
     ID %in%WM_2015_69~"2015_69",
     ID %in%WM_2015_75~"2015_75",
     ID %in%WM_2015_78~"2015_78",
     ID %in%WM_2015_97~"2015_97",
     ID %in%WM_2015_98~"2015_98",
     ID %in%WM_2015_99~"2015_99",
     ID %in%WM_2015_100~"2015_100",
     ID %in%WM_2015_101~"2015_101",
     ID %in%WM_2015_102~"2015_102",
     ID %in%WM_2015_103~"2015_103",
     ID %in%WM_2015_104~"2015_104",
     ID %in%WM_2015_Al~"2015_Al",
     ID %in%WM_2015_Hi~"2015_Hi",
     ID %in%WM_2015_In~"2015_In",
     ID %in%WM_2015_mont~"2015_mont",
     ID %in%WM_2015_Sand~"2015_Sand",
     ID %in%WM_2015_Sani~"2015_Sani",
     ID %in%WM_2015_St~"2015_St",
     ID %in%WM_2015_wau~"2015_wau",
     ID %in%WM_2015_la~"2015_la",
     ID %in%WM_2015_co~"2015_co",
     ID %in%WM_2015_cern~"2015_cern",
     ID %in%WM_2015_cer~"2015_cer",
     ID %in%WM_2010~"2010",
     ID %in%WM_2017~"2017",
     TRUE ~ "no specific field"
   ),
   State= case_when(
     ID %in%WM_AB~"AB",
     ID %in%WM_AZ~"AZ",
     ID %in%WM_BA~"BA",
     ID %in%WM_CA~"CA",
     ID %in%WM_CO~"CO",
     ID %in%WM_DE~"DE",
     ID %in%WM_DF~"DF",
     ID %in%WM_FL~"FL",
     ID %in%WM_GA~"GA",
     ID %in%WM_GO~"GO",
     
     ID %in%WM_IA~"IA",
     ID %in%WM_ID~"ID",
     ID %in%WM_KS~"KS",
     ID %in%WM_KY~"KY",
     ID %in%WM_LA~"LA",
     ID %in%WM_MD~"MD",
     ID %in%WM_MG~"MG",
     ID %in%WM_MI~"MI",
     ID %in%WM_MN~"MN",
     ID %in%WM_MO~"MO",
     
     ID %in%WM_MS~"MS",
     ID %in%WM_MT~"MT",
     ID %in%WM_NC~"NC",
     ID %in%WM_ND~"ND",
     ID %in%WM_NE~"NE",
     ID %in%WM_NY~"NY",
     ID %in%WM_OH~"OH",
     ID %in%WM_OK~"OK",
     ID %in%WM_ON~"ON",
     ID %in%WM_OR~"OR",
     
     ID %in%WM_PA~"PA",
     ID %in%WM_PR~"PR",
     ID %in%WM_QUE~"QUE",
     ID %in%WM_RS~"RS",
     ID %in%WM_SC~"SC",
     ID %in%WM_SIN~"SIN",
     ID %in%WM_SK~"SK",
     ID %in%WM_WI~"WI",
     ID %in%WM_WA~"WA"
     
   )
   ) %>% select(-c(new)) %>% 
   mutate(Country = as.factor(Country),
          Year_Field = as.factor(Year_Field),
          State= as.factor(State) ) %>% 
   arrange(ID)
 
 ###For comparisons between hosts I had to take out the ones coming from baseline otherwise would not be fair
 
 tetraconazole.complete.host <-tetraconazole.complete %>% 
   filter(!source=="Baseline")
 
 ###For isolates from that have reduced sensitivity, assess sensitivity for isolates in the same field to account for heterogeneicity
 ##WITH MEXICO & BRAZIL together
 # tetraconazole.complete.fields.cristian <-tetraconazole.complete.cris%>%
 #   filter(  Field== "Baseline"|
 #              State== "CO"|
 #              State== "NE"|
 #              State== "ND"|
 #              State== "WA"|
 #              State== "MI"|
 #              Country== "Mexico"|
 #              Country== "Brazil"
 #   ) %>%
 #   arrange(source) %>%
 #    #
 #   mutate(State= as.character(State),
 #          State =  ifelse(Field == "Baseline", "Baseline", State),
 #          State = as.factor(State)) %>%
 #   filter(Year_Field == "2007_production_1"|
 #            Year_Field == "2007_production_2"|
 #            Year_Field == "2007_production_3"|
 #            Year_Field == "2007_production_4"|
 #            Year_Field == "2007_production_5"|
 #            Year_Field == "2007_production_6"|
 #            Year_Field == "2007_production_7"|
 #            Year_Field == "2007_production_8"|
 #            Year_Field == "2007_production_9"|
 #            Year_Field == "2008_production_10"|
 #            Year_Field == "2008_production_11"|
 #            Year_Field == "2008_production_12"|
 #            Year_Field == "2008_production_13"|
 #            Year_Field == "2009_production_17"|
 #            Year_Field == "2009_production_19"|
 #            Year_Field == "2009_production_20"|
 #            Year_Field == "2010_production_21"|
 #            Year_Field == "2007_production_22"|
 #            Year_Field == "2007_production_23"|
 #            Year_Field == "2007_production_24"|
 #            Year_Field == "2007_production_25"|
 #            Year_Field == "2007_production_26"|
 #            Year_Field == "2007_production_27"|
 #            Year_Field == "2007_production_28"|
 #            Year_Field == "2007_production_29"|
 #            Year_Field == "2007_production_30"|
 #            State == "Baseline"|
 #            Country== "Mexico"|
 #            Country== "Brazil") %>%
 #           mutate(State = fct_recode(State, "Mexico & Brazil"= "SIN" , "Mexico & Brazil"= "GO", "Mexico & Brazil" = "MG"))
 # 

 tetraconazole.complete.fields.cristian <-tetraconazole.complete.cris%>% 
   filter(  Field== "Baseline"|
              State== "CO"|
              State== "NE"|
              State== "ND"| 
              State== "WA"|
              State== "MI"
   ) %>% 
   arrange(source) %>% 
   filter( !source == "Fungicide Field Trials") %>% 
   
   mutate(State= as.character(State), 
          State =  ifelse(Field == "Baseline", "Baseline", State),
          State = as.factor(State)) %>% 
   filter(Year_Field == "2007_production_1"|
            Year_Field == "2007_production_2"|
            Year_Field == "2007_production_3"|
            Year_Field == "2007_production_4"|
            Year_Field == "2007_production_5"|
            Year_Field == "2007_production_6"|
            Year_Field == "2007_production_7"|
            Year_Field == "2007_production_8"|
            Year_Field == "2007_production_9"|
            Year_Field == "2008_production_10"|
            Year_Field == "2008_production_11"|
            Year_Field == "2008_production_12"|
            Year_Field == "2008_production_13"|
            Year_Field == "2009_production_17"|
            Year_Field == "2009_production_19"|
            Year_Field == "2009_production_20"|
            Year_Field == "2010_production_21"|
            Year_Field == "2007_production_22"|
            Year_Field == "2007_production_23"|
            Year_Field == "2007_production_24"|
            Year_Field == "2007_production_25"|
            Year_Field == "2007_production_26"|
            Year_Field == "2007_production_27"|
            Year_Field == "2007_production_28"|
            Year_Field == "2007_production_29"|
            Year_Field == "2007_production_30"|
            State == "Baseline") %>% 
   arrange(EC50DC)
 
 # total 124 isolates
 
 tetraconazole.complete.fields.cristian$State <-
   factor(tetraconazole.complete.fields.cristian$State,
 c("WA", "MI", "Baseline", "ND", "CO", "NE"))

```

##  Statistical analysis  
###  By Field (previous Source) but because the name actually is "State"  

```{r Normality in Tetraconazole, include= FALSE}

 #by field but because the name actually is "State"
 
 ##NORMALITY TEST-Shapiro_test
 
 shapiro.test.tetra.cristian <- tetraconazole.complete.fields.cristian %>%
   do(tidy(shapiro.test(.$EC50DC)))
 shapiro.test.tetra.cristian[[2]][[1]]
 #p value is = 8.589226e-05
 # No normals
 
 
```
##  No normality, p value = `r shapiro.test.tetra.cristian[[2]][[1]]`    

##  Kruskal Wallis test 

```{r kruskal wallis in Tetraconazole, echo = FALSE, include=FALSE, warning= FALSE}
object.7.cristian <- kruskal.test(EC50DC ~ State, data = tetraconazole.complete.fields.cristian)
 object.7.cristian[[3]][[1]]
 
 #There is difference difference,  p-value = 4.271203e-05
 
```
##  There is difference,  p value =  `r object.7.cristian[[3]][[1]]`    
##  Dunn test
```{r Dunn test in Tetraconazole, echo= FALSE}
object.8.cristian <-  DunnTest(EC50DC ~ State, data = tetraconazole.complete.fields.cristian, method = "bonferroni")
 object.8.cristian
 
#  Dunn's test of multiple comparisons using rank sums : bonferroni  
# 
#             mean.rank.diff    pval    
# MI-WA             5.166209 1.00000    
# Baseline-WA      -6.196429 1.00000    
# ND-WA            -4.606366 1.00000    
# CO-WA           -24.085714 0.33024    
# NE-WA           -46.752820 0.00018 ***
# Baseline-MI     -11.362637 1.00000    
# ND-MI            -9.772575 1.00000    
# CO-MI           -29.251923 0.33415    
# NE-MI           -51.919028 0.00089 ***
# ND-Baseline       1.590062 1.00000    
# CO-Baseline     -17.889286 1.00000    
# NE-Baseline     -40.556391 0.00544 ** 
# CO-ND           -19.479348 1.00000    
# NE-ND           -42.146453 0.00231 ** 
# NE-CO           -22.667105 0.73328    
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#  
 
 
```
There is difference  

##  Plot
```{r Plot in Tetraconazole, echo = FALSE, include=FALSE, warning= FALSE}
 plot.tetra.3.cristian <- tetraconazole.complete.fields.cristian %>%
   ggplot(aes(x = State, y = EC50DC)) +
   geom_jitter(
     width = .1,
     height = 0,
     shape = 21,
     color = "black",
     fill = "deepskyblue",
     size = 2,
     alpha = 3 / 4
   ) + stat_summary(
     fun.y = mean,
     geom = "point",
     shape = 95,
     size = 15,
     color = "black"
   ) +
   labs(x = "State", y = expression(bold(EC[bold("50") ~ (bold("D"))]) ~
                                      (bold(ppm ~ bold(
                                        "a.i."
                                      ))))) + theme(
                                        panel.border = element_rect(
                                          colour = "black",
                                          fill = NA,
                                          size = 1
                                        ),
                                        axis.title = element_text(size = 10, face = "bold", hjust = 0.5),
                                        axis.text = element_text(
                                          face = "bold",
                                          size = 10,
                                          family = "Arial"
                                        ),
                                        panel.background = element_rect(fill = "white", colour = "grey50")
                                      ) + scale_y_continuous(breaks = c(0.4, 0.6, 0.8, 1, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0))
 
 
 
 
```

```{r}
plot.tetra.3.cristian

```
```{r}
isolates_Mexico.Brazil.experiment.using <-  sort ( unique( c (461, 
                                             1901, 
                                             1899,
                                             1898,
                                             2489,
                                             2488,
                                             2545,
                                             2542,
                                             2513,
                                             2484,
                                             2483,
                                             2481,
                                             1931,
                                             1922,
                                             1921,
                                             1920,
                                             1907,
                                             2512,
                                             2511,
                                             2510,
                                             1930,
                                             1929,
                                             1928,
                                             1926,
                                             1924,
                                             1923,
                                             1892,
                                             1891,
                                             1890,
                                             1889,
                                             1888,
                                             1887,
                                             1884,
                                             1896,
                                             1895,
                                             1894,
                                             1893,
                                             2487,
                                             2486,
                                             2485,
                                             1906,
                                             1905,
                                             1904,
                                             1903,
                                             1902,
                                             2507,
                                             2506,
                                             2505,
                                             2504,
                                             2490,
                                             2547,
                                             2546,
                                             2509,
                                             2508,
                                             2557,
                                             2554,
                                             2552,
                                             2551,
                                             2550,
                                             2548
                                             
)))


```


```{r}
save(list = ls(all=TRUE), file= "Cristian.Rdata")
 rm(list = ls())
```

